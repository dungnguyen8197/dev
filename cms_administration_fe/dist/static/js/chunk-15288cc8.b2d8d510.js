(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15288cc8"],{6367:function(e,t,a){},a7ae:function(e,t,a){"use strict";a.r(t);var n=a("2909"),o=(a("b0c0"),a("4de4"),a("d3b7"),function(){var e=this,t=e._self._c;return t("el-row",{staticStyle:{margin:"20px","font-family":"Sans-serif"}},[t("el-row",[t("el-col",{attrs:{sm:24}},[t("h3",{staticStyle:{margin:"0",width:"100%",padding:"10px","text-align":"center"}},[e._v(e._s("MÀN KẾ TOÁN"))])])],1),t("div",{staticClass:"clearfix-20"}),t("el-row",[t("el-col",{attrs:{sm:24}},[t("h4",{staticStyle:{margin:"0",width:"100%",padding:"10px",color:"red","text-align":"center"}},[e._v(" "+e._s("Tổng số tiền: ".concat(e.formatNumber(e.total_money)," VNĐ"))+" ")])])],1),t("div",{staticClass:"filter-container"},[t("el-row",[t("el-col",{staticClass:"mb-10"},[t("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v(" Thêm mới ")])],1)],1),t("el-row",{staticClass:"row-search-money"},[t("el-col",{staticClass:"search-money",attrs:{span:6}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-select",{ref:"SearchAdmin",staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","reserve-keyword":"",clearable:"",placeholder:"Nhập tên sale","remote-method":e.onSearchAdmin,loading:e.loadingSearchAdmin},on:{"hook:mounted":function(t){return e.cancelReadOnly(t,"SearchAdmin")},"visible-change":function(t){return e.cancelReadOnly(t,"SearchAdmin")}},model:{value:e.query.admin_id,callback:function(t){e.$set(e.query,"admin_id",t)},expression:"query.admin_id"}},e._l(e.admins,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]),t("el-col",{staticClass:"search-money",attrs:{span:6}},[t("div",{staticClass:"grid-content bg-purple-light"},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",remote:"","reserve-keyword":"","multiple-limit":1,placeholder:"Tìm kiếm theo trạng thái"},model:{value:e.query.is_clear,callback:function(t){e.$set(e.query,"is_clear",t)},expression:"query.is_clear"}},e._l(e.statusList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),t("el-col",{staticClass:"search-money",attrs:{span:6}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"","multiple-limit":1,placeholder:"Số tài khoản"},model:{value:e.query.bank_account_number,callback:function(t){e.$set(e.query,"bank_account_number",t)},expression:"query.bank_account_number"}},e._l(e.bankAccountList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),t("el-col",{staticClass:"search-money",attrs:{span:6}},[t("div",{staticClass:"grid-content bg-purple-light"},[t("el-input",{attrs:{placeholder:"Nhập mã booking"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter.apply(null,arguments)}},model:{value:e.query.code_booking,callback:function(t){e.$set(e.query,"code_booking",t)},expression:"query.code_booking"}})],1)])],1),t("el-row",{staticClass:"row-search-money"},[t("el-col",{staticClass:"search-money",attrs:{span:6}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-input",{attrs:{placeholder:"Nhập Nội dung CK"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter.apply(null,arguments)}},model:{value:e.query.transfer_content,callback:function(t){e.$set(e.query,"transfer_content",t)},expression:"query.transfer_content"}})],1)]),t("el-col",{staticClass:"search-money",attrs:{span:4}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-input",{attrs:{placeholder:"Nhập số tiền"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter.apply(null,arguments)}},model:{value:e.query.amount_money,callback:function(t){e.$set(e.query,"amount_money",t)},expression:"query.amount_money"}})],1)]),t("el-col",{staticClass:"search-money",attrs:{span:4}},[t("div",{staticClass:"grid-content bg-purple-light"},[t("el-input",{attrs:{placeholder:"Ghi chú"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter.apply(null,arguments)}},model:{value:e.query.note,callback:function(t){e.$set(e.query,"note",t)},expression:"query.note"}})],1)]),t("el-col",{staticClass:"search-money",attrs:{span:4}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",remote:"","reserve-keyword":"","multiple-limit":1,placeholder:"Nguồn tạo"},model:{value:e.query.source_type,callback:function(t){e.$set(e.query,"source_type",t)},expression:"query.source_type"}},e._l(e.sourceList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),t("el-col",{staticClass:"search-money",attrs:{span:6}},[t("div",{staticClass:"grid-content bg-purple-light"},[t("el-date-picker",{staticClass:"w-100",attrs:{format:"dd-MM-yyyy HH:mm:ss",type:"datetimerange","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1)])],1),t("el-row",[t("el-col",{staticClass:"mr-10 mt-10 filter-search",attrs:{sm:12,md:8}},[t("el-button",{attrs:{icon:"el-icon-refresh",round:""},on:{click:e.onReset}},[e._v("Reset")]),t("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(" Tìm kiếm ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-download",loading:e.loadingExportExcel},on:{click:e.handleDownload}},[e._v(" Export excel ")])],1)],1)],1),t("div",{staticClass:"clearfix-10"}),t("el-row",{staticStyle:{"margin-top":"40px"}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTable,expression:"loadingTable"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{label:"STT",width:"100",align:"center",type:"index",index:e.handleIndexMethod}}),t("el-table-column",{attrs:{label:"Nguồn tạo",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[0==a.row.source_type?t("el-tag",{attrs:{type:"success"}},[e._v("Hệ thống tạo")]):t("el-tag",{attrs:{type:"warning"}},[e._v("CMS tạo")])]}}])}),t("el-table-column",{attrs:{prop:"date_transaction",label:"Ngày",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.date_transaction?e.convertDateTime(t.row.date_transaction):"")+" ")]}}])}),t("el-table-column",{attrs:{prop:"amount_money",label:"Số tiền",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.amount_money?e.formatNumber(t.row.amount_money):"")+" ")]}}])}),t("el-table-column",{attrs:{prop:"bank_account_number",label:"Số tài khoản",align:"center"}}),t("el-table-column",{attrs:{prop:"bank_name",label:"Ngân hàng",align:"center"}}),t("el-table-column",{attrs:{prop:"code_payment",label:"Mã thanh toán",align:"center"}}),t("el-table-column",{attrs:{prop:"trace_code",label:"trace code",align:"center"}}),t("el-table-column",{attrs:{label:"Mã BK",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.booked.length>0?[e._l(Object(n["a"])(a.row.code_booking.split(",")),(function(a){return[t("el-tag",{key:a},[e._v(e._s(a))])]}))]:a.row.code_booking?[e._l(a.row.code_booking.split(","),(function(a){return[t("el-tag",{key:a},[e._v(e._s(a))])]}))]:e._e()]}}])}),t("el-table-column",{attrs:{prop:"note",label:"NOTE",align:"center"}}),t("el-table-column",{attrs:{prop:"transfer_content",label:"Nội dung chuyển khoản",align:"center"}}),t("el-table-column",{attrs:{label:"TT Clear",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[[1===a.row.is_clear?t("el-tag",{attrs:{type:"success"}},[e._v("Clear")]):t("el-tag",{attrs:{type:"warning"}},[e._v("No")])],[1===a.row.is_system_clear?t("el-tag",{attrs:{type:"success"}},[e._v("Hệ thống Clear")]):e._e()]]}}])}),t("el-table-column",{attrs:{prop:"sale.name",label:"Sale xử lý",align:"center"}}),t("el-table-column",{attrs:{label:"Hành động",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return t("section",{staticStyle:{display:"flex","align-items":"center"}},[t("section",{staticClass:"mr-10"},[t("el-button",{staticClass:"mb-10",attrs:{type:"warning",size:"small"},on:{click:function(t){return e.confirmClear(a.row)}}},[e._v("Cập nhật TT Clear ")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("Edit ")])],1)])}}])})],1),t("el-row",{staticClass:"list-device__footer"},[t("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>e.query.limit,expression:"total > query.limit"}],attrs:{total:e.total,limit:e.query.limit,page:e.query.page},on:{"update:limit":function(t){return e.$set(e.query,"limit",t)},"update:page":function(t){return e.$set(e.query,"page",t)},pagination:e.onGetList}}),t("dialog-edit-history",{attrs:{"show-dialog":e.showDialogUpdateRow,"is-add":e.isAdd,"object-data":e.objectDataEdit},on:{onCloseDialog:e.handleClose}}),t("dialog-confirm-process",{attrs:{"dialog-confirm-process":e.dialogConfirmProcess,"object-data":e.objectData},on:{onCloseDialog:e.handleClose}}),t("el-dialog",{attrs:{title:"Xác nhận xong ",visible:e.dialogConfirmDone,width:"30%",center:""},on:{"update:visible":function(t){e.dialogConfirmDone=t}}},[t("span",[e._v('Bạn có xác nhận đã "DONE" ?')]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogConfirmDone=!1}}},[e._v("Cancel")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirmDone()}}},[e._v("Confirm")])],1)]),t("el-dialog",{attrs:{title:"Xác nhận clear or no ",visible:e.dialogConfirmClear,"before-close":function(){e.body={},e.dialogConfirmClear=!1},width:"30%",center:""},on:{"update:visible":function(t){e.dialogConfirmClear=t}}},[t("el-form",[t("el-form-item",{attrs:{label:"Chọn hình thức thanh toán"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"Chọn hình thức thanh toán",size:"small"},model:{value:e.body.type_purchase,callback:function(t){e.$set(e.body,"type_purchase",t)},expression:"body.type_purchase"}},e._l(e.arrayTypePurchase.filter((function(e){return 14!=e.value&&e.value>0})),(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.handleConfirmClear(e.clear=0)}}},[e._v("No")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleConfirmClear(e.clear=1)}}},[e._v("Clear")])],1)],1)],1)],1)],1)}),l=[],i=(a("498a"),a("d81d"),a("6062"),a("3ca3"),a("ddb0"),a("a15b"),a("caad"),a("2532"),a("333d")),r=a("01bc"),s=a("e0cb"),c=a("bcc2"),d=a("c1df"),u=a.n(d),h=a("5f87"),m=a("2ea5"),p=a("b274"),y=a("60fe"),b=new r["a"],g=new s["a"],f={name:"MoneyIn",components:{Pagination:i["a"],DialogEditHistory:m["a"],DialogConfirmProcess:p["a"]},data:function(){return{loadingTable:!1,tableData:[],query:{limit:10,page:1,type:2},total:20,loadingExportExcel:!1,statusList:[{label:"no",value:0},{label:"clear",value:1}],sourceList:[{label:"Hệ thống tạo",value:0},{label:"CMS tạo",value:1}],bankAccountList:y["g"],total_money:0,dialogUpdateNote:!1,objectData:{},objectDataEdit:{},showDialogUpdateRow:!1,adminData:[],loadingSearchAdmin:!1,dateRange:"",dialogConfirmDone:!1,dialogConfirmClear:!1,dialogConfirmProcess:!1,body:{},request:{},timer:"",isAdd:!0,admins:[],arrayTypePurchase:y["c"]}},computed:{datePickerOptions:function(){var e=this;return{disabledDate:function(t){var a=new Date(e.query.start_date);return a.setDate(a.getDate()+1),t.getTime()<a.getTime()}}}},watch:{dateRange:function(e){e?(this.query.start_date=u()(e[0]).unix(),this.query.end_date=u()(e[1]).unix()):(this.query.start_date="",this.query.end_date="")}},created:function(){this.onGetList()},beforeDestroy:function(){clearInterval(this.timer)},methods:{checkAdmin:function(e){var t,a;return(null===e||void 0===e||null===(t=e.sale)||void 0===t?void 0:t.id)===(null===(a=this.admin)||void 0===a?void 0:a.id)},onGetList:function(){var e=this;this.loadingTable=!0,b.moneyInList(this.query).then((function(t){e.loadingTable=!1;var a=t.error_code,n=t.data;0===a?(e.tableData=n.data,e.total=n.total,e.total_money=n.total_money):e.$message.error("Lỗi hệ thống, vui lòng liên hệ bộ phận kỹ thuật")})).catch((function(t){e.loadingTable=!1}))},onSearchAdmin:function(e){var t=this;this.loadingSearchAdmin=!0,g.searchAdmin({keyword_admin:e.trim()}).then((function(e){t.loadingSearchAdmin=!1;var a=e.error_code,n=e.data;0===a&&(t.admins=n)}))},handleFilter:function(){this.query.page=1,this.loadingTable=!0,this.onGetList()},onReset:function(){this.query=Object.assign({},{page:1,limit:10,type:2}),this.dateRange="",this.onGetList()},handleDownload:function(){var e=this;this.loadingExportExcel=!0;var t=Object.assign({},this.query);delete t.limit,delete t.page,b.exportExcel(t).then((function(t){var o=t.error_code,l=t.data;0===o?(e.dataExcel=l.data,e.dataExcel.map((function(e,t){if(e.index=t+1,e.sale){var a=e.sale.name;e.sale_name=a}if(e.admin){var o=e.admin.name;e.admin_name=o}if(e.booked){var l=Object(n["a"])(new Set(e.booked.map((function(e){return e.code_booking}))));e.booked=l.join(),console.log(e.booked)}e.source_name=0===e.source_type?"Hệ thống tạo":"CMS tạo",e.clear=0===e.is_clear?"No":"Clear"})),Promise.all([a.e("chunk-6e83591c"),a.e("chunk-5164a781"),a.e("chunk-39e3bbe0"),a.e("chunk-f440bdbc")]).then(a.bind(null,"4bf8")).then((function(t){var a=["STT","Sale xử lý","Nguồn tạo","TT clear","Ngày","Số tiền","Số tài khoản","Ngân hàng","Mã thanh toán","trace code","Mã BK","Note","Nội dung chuyển khoản","Admin"],n=["index","sale_name","source_name","clear","date_transaction","amount_money","bank_account_number","bank_name","code_payment","trace_code","booked","note","transfer_content","admin_name"],o=e.dataExcel;o=e.formatJson(n,o),t.export_json_to_excel({header:a,data:o,filename:"TopUpCms"})}))):e.$message.error("Lỗi hệ thống, vui lòng liên hệ bộ phận kỹ thuật")})).catch((function(t){e.loadingExportExcel=!1})).finally((function(t){e.loadingExportExcel=!1}))},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},handleIndexMethod:function(e){return 1===this.query.page?this.query.page+e:(this.query.page-1)*this.query.limit+e+1},handleEditNote:function(e){this.dialogUpdateNote=!0,this.objectData=Object.assign({},e)},handleClose:function(){this.dialogUpdateNote=!1,this.showDialogUpdateRow=!1,this.dialogConfirmProcess=!1,this.onGetList()},handleEdit:function(e){this.isAdd=!1,this.showDialogUpdateRow=!0,this.objectDataEdit=Object.assign({},e)},handleAdd:function(){this.isAdd=!0,this.showDialogUpdateRow=!0,this.objectDataEdit={}},confirmDone:function(e){this.dialogConfirmDone=!0,this.query.id=e.id,this.request.time_done=u()().format("YYYY-MM-DD HH:mm:ss")},handleConfirmDone:function(){},confirmClear:function(e){this.dialogConfirmClear=!0,this.query.id=e.id,this.body={},this.body.date_transaction=u()(e.date_transaction).format("YYYY-MM-DD HH:mm:ss"),e.code_booking.includes("GB")?this.body.list_code_GB=e.code_booking.split(",").filter((function(e){return e.includes("GB")})):this.body.list_code_GB=[]},handleConfirmClear:function(e){var t=this;if(this.body.type_purchase||1!==e){var a=Object(h["a"])();this.body.admin_id=a.id,this.body.is_clear=e,console.log("body..........",this.body),b.confirmClear(this.body,this.query.id).then((function(e){var a=e.error_code,n=e.error_msg;0===a?(t.$message.success("Clear thành công"),t.dialogConfirmClear=!1,t.onGetList()):t.$message.error(n)}))}else this.$message.warning("Bạn cần chọn hình thức thanh toán !!")},confirmProcess:function(e){this.dialogConfirmProcess=!0,e.baseUrl=this.baseUrl,this.objectData=Object.assign({},e)},unConfirmProcess:function(e){},cancelReadOnly:function(e,t){var a=this;this.$nextTick((function(){if(!e){var n=a.$refs[t],o=n.$el.querySelector(".el-input__inner");o.removeAttribute("readonly")}}))},formatNumber:c["k"],convertDateTime:c["b"]}},_=f,v=(a("d159"),a("2877")),k=Object(v["a"])(_,o,l,!1,null,"43c1820a",null);t["default"]=k.exports},d159:function(e,t,a){"use strict";a("6367")}}]);