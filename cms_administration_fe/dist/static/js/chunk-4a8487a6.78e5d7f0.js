(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a8487a6"],{"0743":function(t,e,a){"use strict";function o(t){navigator.clipboard.writeText(t).then((function(){console.log("Text copied to clipboard:",t)})).catch((function(t){console.error("Unable to copy text to clipboard:",t)}))}a.d(e,"a",(function(){return o}))},2403:function(t,e,a){"use strict";a("392e")},"29c9":function(t,e,a){"use strict";a("c258")},"392e":function(t,e,a){},"3e48":function(t,e,a){"use strict";a("5f8e")},"3f27":function(t,e,a){},"50b4":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var o=a("b85c");a("d3b7"),a("159b"),a("14d9"),a("7db0");function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[],a=[];return t.forEach((function(t){t.param_second&&a.push(t.param_second),t.param_first&&e.push(t.param_first)})),e=n(e),a=n(a),{list_attr1:e,list_attr2:a}}function n(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=[],i=Object(o["a"])(e);try{var n=function(){var e=t.value,o=a.find((function(t){return t===e}));o||a.push(e)};for(i.s();!(t=i.n()).done;)n()}catch(r){i.e(r)}finally{i.f()}return a}},"5f8e":function(t,e,a){},"7db0":function(t,e,a){"use strict";var o=a("23e7"),i=a("b727").find,n=a("44d2"),r="find",l=!0;r in[]&&Array(1)[r]((function(){l=!1})),o({target:"Array",proto:!0,forced:l},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(r)},"94de":function(t,e,a){"use strict";a.r(e);a("b0c0"),a("fb6a");var o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"received-note"}},[t.showDialogAddDeliveryNote?e("addDeliveryNote",{attrs:{"show-detail":t.showDialogAddDeliveryNote},on:{"close-dialog":function(e){t.showDialogAddDeliveryNote=!1},"success-create-note":t.resetFilter}}):t._e(),t.showDialogEditDeliveryNote?e("editDeliveryNote",{attrs:{id:t.edit_id,"show-detail":t.showDialogEditDeliveryNote},on:{"close-dialog":function(e){t.showDialogEditDeliveryNote=!1},"success-edit-note":t.handleSuccessEdit}}):t._e(),t.showDialogViewDeliveryNote?e("viewDeliveryNote",{attrs:{id:t.view_id,"show-detail":t.showDialogViewDeliveryNote},on:{"close-dialog":function(e){t.showDialogViewDeliveryNote=!1}}}):t._e(),e("div",{staticStyle:{width:"100",display:"flex","justify-content":"space-between"}},[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("p",{staticStyle:{"margin-right":"15px","margin-bottom":"0px"},on:{click:t.onBack}},[e("i",{staticClass:"el-icon-back"})]),e("h3",{staticStyle:{margin:"0px"}},[t._v("Quản lý phiếu xuất kho")])]),e("div",{staticStyle:{display:"flex","justify-content":"end",height:"40px"}},[t.is_write?e("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.onAddReceivedNote}},[t._v("Tạo phiếu xuất kho")]):t._e(),e("el-button",{attrs:{icon:"el-icon-refresh",loading:t.loading},on:{click:t.resetFilter}},[t._v("Làm mới")])],1)]),e("div",{staticStyle:{display:"flex","justify-content":"space-between","flex-wrap":"wrap","margin-top":"10px"}},[e("div",[e("el-input",{staticStyle:{width:"160px"},attrs:{type:"text",rows:2,placeholder:"Nhập để tìm kiếm"},model:{value:t.listQuery.q,callback:function(e){t.$set(t.listQuery,"q",e)},expression:"listQuery.q"}},[e("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]),e("el-select",{staticStyle:{width:"200px","margin-left":"10px"},attrs:{placeholder:"Trạng thái đơn"},model:{value:t.filterSearch,callback:function(e){t.filterSearch=e},expression:"filterSearch"}},t._l(t.searchOption,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.onSearchDeliveryNote}},[t._v("Tìm kiếm")])],1),e("div",{staticStyle:{display:"flex"}},[e("el-date-picker",{staticStyle:{width:"300px"},attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"Đến","start-placeholder":"Ngày bắt đầu","end-placeholder":"Ngày kết thúc"},on:{change:t.handleChangeDateRange},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)]),e("div",{staticStyle:{"margin-top":"10px"},attrs:{id:"brand-table-id"}},[e("el-tabs",{on:{"tab-click":t.handleChangeTab},model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[e("el-tab-pane",{attrs:{label:"Danh sách phiếu xuất",name:"first"}}),e("el-tab-pane",{attrs:{label:"Phiếu xuất đã hủy",name:"second"}})],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,align:"center",border:""}},[e("el-table-column",{attrs:{prop:"id",label:"Mã phiếu xuất",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-link",{staticStyle:{color:"#4CA1D5"},attrs:{underline:!1},on:{click:function(e){return t.handleView(a.row)}}},[t._v("XK"+t._s(a.row.id))])]}}])}),e("el-table-column",{attrs:{prop:"name",label:"Tên phiếu xuất",align:"center"}}),e("el-table-column",{attrs:{prop:"delivery_id",label:"ID Bill",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.delivery_id?"DL".concat(e.row.delivery_id):"")+" ")]}}])}),e("el-table-column",{attrs:{prop:"total_number",label:"Số lượng",align:"center"}}),e("el-table-column",{attrs:{prop:"total_price",label:"Tổng tiền",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.formatNumber(e.row.total_price))+"đ ")]}}])}),e("el-table-column",{attrs:{prop:"export_time",label:"Ngày xuất kho",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.export_time?new Date(e.row.export_time).toISOString().slice(0,10):t.handleImportTime(e.row.import_time))+" ")]}}])}),e("el-table-column",{attrs:{prop:"user.username",label:"Người xuất",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[1===a.row.type_system?e("span",[t._v("Hệ thống")]):e("span",[t._v(t._s(a.row.user.username))])]}}])}),e("el-table-column",{attrs:{prop:"noted",label:"Ghi chú",align:"center"}}),"first"===t.tabName?e("el-table-column",{attrs:{prop:"action",label:"Hành động",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[!a.row.type_system&&t.is_edit?e("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(e){return t.handleEdit(a.row)}}}):t._e(),!a.row.type_system&&t.is_delete?e("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.handleDelete(a.row)}}}):t._e()]}}],null,!1,780656678)}):t._e()],1),e("el-row",[e("pagination",{attrs:{total:t.total,limit:t.listQuery.limit,page:t.listQuery.page},on:{"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},"update:page":function(e){return t.$set(t.listQuery,"page",e)},pagination:t.getTableData}})],1)],1)],1)},i=[],n=a("3835"),r=(a("ac1f"),a("5319"),a("e9c4"),a("d3b7"),a("d9e2"),a("99af"),a("4d90"),a("333d")),l=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.showDetail,"before-close":t.handleClose,top:"1vh",width:"90%"},on:{"update:visible":function(e){t.showDetail=e}}},[e("el-form",{ref:"ruleForm",staticStyle:{"margin-bottom":"40px"},attrs:{rules:t.rules,model:t.objData}},[e("h5",{staticStyle:{color:"black"}},[t._v("TẠO PHIẾU XUẤT KHO")]),e("div",{staticStyle:{border:"1px solid gainsboro",padding:"30px 20px","margin-top":"20px"}},[e("div",{staticStyle:{display:"flex","justify-content":"left"}},[e("div",{staticStyle:{width:"25%"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Mã phiếu xuất"))]),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0,placeholder:"Mã phiếu xuất"},model:{value:t.note_code,callback:function(e){t.note_code=e},expression:"note_code"}})],1),e("div",{staticStyle:{width:"25%","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Ngày xuất kho")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"dateDeliveryNote"}},[e("el-date-picker",{staticStyle:{"margin-top":"10px",width:"100%"},attrs:{type:"date",prop:"dateDeliveryNote",placeholder:"Ngày xuất kho"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmitForm("ruleForm")}},model:{value:t.dateDeliveryNote,callback:function(e){t.dateDeliveryNote=e},expression:"dateDeliveryNote"}})],1)],1),e("div",{staticStyle:{flex:"1","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Tên phiếu xuất kho")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"purpose"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{prop:"purpose",placeholder:"Tên phiếu xuất kho"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmitForm("ruleForm")}},model:{value:t.dataBody.purpose,callback:function(e){t.$set(t.dataBody,"purpose",e)},expression:"dataBody.purpose"}})],1)],1)]),e("div",{staticStyle:{display:"flex","justify-content":"left","margin-top":"20px"}},[e("div",{staticStyle:{width:"25%"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Bên nhận")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"receiving"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{prop:"receiving",placeholder:"Bên nhận"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmitForm("ruleForm")}},model:{value:t.dataBody.receiving,callback:function(e){t.$set(t.dataBody,"receiving",e)},expression:"dataBody.receiving"}})],1)],1),e("div",{staticStyle:{width:"25%","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("SĐT"))]),e("el-form-item",{attrs:{prop:"phone"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"SĐT"},model:{value:t.dataBody.phone,callback:function(e){t.$set(t.dataBody,"phone",e)},expression:"dataBody.phone"}})],1)],1),e("div",{staticStyle:{flex:"1","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Địa chỉ"))]),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"Địa chỉ"},model:{value:t.dataBody.address,callback:function(e){t.$set(t.dataBody,"address",e)},expression:"dataBody.address"}})],1)]),e("div",{staticStyle:{"margin-top":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Ghi chú"))]),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"Ghi chú"},model:{value:t.dataBody.noted,callback:function(e){t.$set(t.dataBody,"noted",e)},expression:"dataBody.noted"}})],1)])]),e("div",[e("h5",[t._v("Thông tin hàng hóa")]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{label:"Mã sản phẩm",align:"center",width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:a.row.product_code,callback:function(e){t.$set(a.row,"product_code",e)},expression:"scope.row.product_code"}},[e("template",{slot:"append"},[e("el-button",{staticStyle:{padding:"0px"},attrs:{icon:"el-icon-document"},on:{click:function(e){return t.copyClipboard(a.row.product_code)}}})],1)],2)]}}])}),e("el-table-column",{attrs:{label:"Tên sản phẩm",align:"center",type:"index",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"Nhập để tìm kiếm","remote-method":t.remoteMethodProduct,loading:t.loadingNameProduct},on:{change:function(e){return t.onChangeProduct(a.row)}},model:{value:a.row.product_code,callback:function(e){t.$set(a.row,"product_code",e)},expression:"scope.row.product_code"}},t._l(t.optionAllProduct,(function(t){return e("el-option",{key:t.id,attrs:{label:t.label,value:t.value}})})),1)]}}])}),e("el-table-column",{attrs:{label:"Mã hàng NCC",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{width:"150",disabled:!0},model:{value:o.product_code_shop,callback:function(e){t.$set(o,"product_code_shop",e)},expression:"row.product_code_shop"}})]}}])}),e("el-table-column",{attrs:{label:"Đơn vị tính",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"Nhập đơn vị tính"},model:{value:o.unit,callback:function(e){t.$set(o,"unit",e)},expression:"row.unit"}})]}}])}),e("el-table-column",{attrs:{label:"Số lượng",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"Nhập số lượng"},model:{value:o.origin_number,callback:function(e){t.$set(o,"origin_number",e)},expression:"row.origin_number"}})]}}])}),e("el-table-column",{attrs:{label:"Giá nhập",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{value:o.price?t.formatNumber(o.price):null,placeholder:"Giá nhập",disabled:!0}})]}}])}),e("el-table-column",{attrs:{label:"Thành tiền",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{value:o.origin_number&&o.price?t.formatNumber(o.origin_number*o.price):null,placeholder:"Giá thành tiền",disabled:!0}})]}}])}),e("el-table-column",{attrs:{prop:"category",label:"Thuộc tính 1",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-select",{attrs:{placeholder:"Chọn thuộc tính 1"},model:{value:o.param_first,callback:function(e){t.$set(o,"param_first",e)},expression:"row.param_first"}},t._l(o.list_attr1,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)]}}])}),e("el-table-column",{attrs:{prop:"category",label:"Thuộc tính 2",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-select",{attrs:{placeholder:"Chọn thuộc tính 2"},model:{value:o.param_second,callback:function(e){t.$set(o,"param_second",e)},expression:"row.param_second"}},t._l(o.list_attr2,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)]}}])}),e("el-table-column",{attrs:{label:"Hành động",align:"center",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.onDeleteRow(a.row)}}})]}}])})],1),e("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",icon:"el-icon-plus",plain:""},on:{click:t.onAddRow}},[t._v("Thêm sản phẩm")]),e("hr"),e("div",{staticStyle:{display:"flex","justify-content":"end"}},[e("p",{staticStyle:{"font-weight":"500",color:"blue","font-size":"medium","margin-right":"30px"}},[t._v("Tổng tiền: "),e("span",{staticStyle:{color:"gray"}},[t._v(t._s(t.formatNumber(t.totalMoneyNote))+" VND")])])]),e("div",{staticStyle:{display:"flex","justify-content":"right","margin-right":"30px"}},[e("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",plain:""},on:{click:t.handleClose}},[t._v("Hủy")]),e("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:t.onSaveNote}},[t._v("Lưu")])],1)],1)],1)},s=[],c=a("c7eb"),d=a("1da1"),u=(a("13d5"),a("d81d"),a("4de4"),a("14d9"),a("7db0"),a("2b0e")),p=a("8c54"),h=a("61f7"),m=a("50b4"),f=a("0743"),y=a("bcc2"),g=new p["a"];u["default"].config.warnHandler=function(t,e,a){};var b={name:"DialogAddDeliveryNote",props:{showDetail:{type:Boolean,default:!1}},data:function(){var t=this;return{objData:{},rules:{receiving:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.receiving,o,"Bên nhận")},trigger:"change"}],purpose:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.purpose,o,"Tên phiếu xuất kho")},trigger:"change"}],phone:[{required:!1,validator:function(e,a,o){return Object(h["o"])(e,t.dataBody.phone,o,"Số điện thoại")},trigger:"change"}],dateDeliveryNote:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.import_time,o,"Ngày xuất kho")},trigger:"change"}]},tableData:[{}],loading:!1,dateDeliveryNote:"",optionShop:[],dataBody:{name:null,purpose:null,import_time:null,receiving:null,noted:null,phone:null,address:null,list_product:null,type:1},listQueryProduct:{page:1,limit:10,q:""},loadingNameProduct:!1,optionAllProduct:[]}},computed:{totalMoneyNote:function(){var t=this.tableData.reduce((function(t,e){return e.origin_number&&e.price?t+e.origin_number*e.price:t}),0);return t||0}},watch:{dateDeliveryNote:function(t){var e=new Date(t),a=e.getTime();this.dataBody.import_time=a}},mounted:function(){this.listAllShop()},methods:{formatNumber:y["k"],format_product_params:m["a"],copyClipboard:f["a"],onSaveNote:function(){this.onSubmitForm("ruleForm")},onSubmitForm:function(t){var e=this;return Object(d["a"])(Object(c["a"])().mark((function a(){return Object(c["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.$refs[t].validate(function(){var t=Object(d["a"])(Object(c["a"])().mark((function t(a){return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a&&(e.dataBody.name=e.dataBody.purpose,e.dataBody.list_product=e.tableData.map((function(t){return{product_id:t.product_id,unit:t.unit,price:parseInt(t.price),cost:parseInt(t.price*t.origin_number),origin_number:parseInt(t.origin_number),param_first:t.param_first,param_second:t.param_second}})),e.createDeliveryNote());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return a.stop()}}),a)})))()},handleClose:function(){this.$emit("close-dialog")},onDeleteRow:function(t){this.tableData=this.tableData.filter((function(e){return e!==t})),console.log(this.tableData,"this.tableData")},onAddRow:function(){this.tableData.push({})},createDeliveryNote:function(){var t=this;g.create_note(this.dataBody).then((function(e){var a=e.error,o=e.data;if(console.log("..........createDeliveryNote ",JSON.stringify(o)),0!==a)throw new Error("Tạo phiếu xuất kho thất bại");t.$message.success("Tạo phiếu xuất kho thành công"),t.$emit("success-create-note"),t.handleClose()})).catch((function(e){console.log("..........createDeliveryNote ",e),t.$message.error(e.message)})),console.log("createDeliveryNote")},listAllShop:function(){var t=this;g.list_shop_all().then((function(e){var a=e.error,o=e.list;if(0!==a)throw new Error("Không lấy được danh sách cửa hàng");t.optionShop=o.map((function(t){return{value:t.id,label:t.name}}))})).catch((function(e){console.log("..........listShopAll ",e),t.$message.error(e.message)}))},requestListProduct:function(){var t=this;this.loadingNameProduct=!0,g.list_product(this.listQueryProduct).then((function(e){var a=e.error,o=e.list;if(0!==a)throw new Error("Không lấy được danh sách sản phẩm");t.optionAllProduct=o.map((function(t){return{id:t.id,value:t.product_code,label:t.name,product_code_shop:t.product_code_shop,params:t.params,price:t.price}}))})).catch((function(e){t.$message.error(e.message)})).finally((function(){t.loadingNameProduct=!1}))},remoteMethodProduct:function(t){""!==t?(this.listQueryProduct.q=t,this.requestListProduct()):this.options=[]},onChangeProduct:function(t){var e=this.optionAllProduct.find((function(e){return e.value===t.product_code}));if(e){t.product_id=e.id,t.product_code_shop=e.product_code_shop,t.params=e.params,t.price=e.price;var a=this.format_product_params(t.params),o=a.list_attr1,i=a.list_attr2;t.list_attr1=o,t.list_attr2=i,console.log(e,"onChangeProduct")}},onSelectAttr1:function(t){var e=t.params.find((function(e){return e.id===t.param_first_id}));t.param_first=e.param_first,t.param_second=e.param_second}}},v=b,_=(a("b185"),a("2877")),w=Object(_["a"])(v,l,s,!1,null,"23851318",null),x=w.exports,S=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.showDetail,"before-close":t.handleClose,top:"1vh",width:"90%"},on:{"update:visible":function(e){t.showDetail=e}}},[t.showEditTableNote?e("editTableNote",{attrs:{type:t.typeHandleDialog,"dialog-form-visible":t.showEditTableNote,"data-body-old":t.dataEditRow,"warehouse-id":t.id},on:{"on-close":function(e){t.showEditTableNote=!1},"on-add":t.addRowNote,"on-edit":t.editRowNote}}):t._e(),e("el-form",{ref:"ruleForm",staticStyle:{"margin-bottom":"40px"},attrs:{rules:t.rules,model:t.objData}},[e("h5",{staticStyle:{color:"black"}},[t._v("THÔNG TIN PHIẾU XUẤT KHO")]),e("div",{staticStyle:{border:"1px solid gainsboro",padding:"30px 20px","margin-top":"20px"}},[e("div",{staticStyle:{display:"flex","justify-content":"left"}},[e("div",{staticStyle:{width:"25%"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Mã phiếu nhập"))]),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:t.note_code,callback:function(e){t.note_code=e},expression:"note_code"}})],1),e("div",{staticStyle:{width:"25%","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Ngày xuất kho")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"dateReceivedNote"}},[e("el-date-picker",{staticStyle:{"margin-top":"10px",width:"100%"},attrs:{type:"date",prop:"dateReceivedNote",placeholder:""},model:{value:t.dateReceivedNote,callback:function(e){t.dateReceivedNote=e},expression:"dateReceivedNote"}})],1)],1),e("div",{staticStyle:{flex:"1","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Tên phiếu xuất kho")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"name"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{prop:"name"},model:{value:t.dataBody.purpose,callback:function(e){t.$set(t.dataBody,"purpose",e)},expression:"dataBody.purpose"}})],1)],1)]),e("div",{staticStyle:{display:"flex","justify-content":"left","margin-top":"20px"}},[e("div",{staticStyle:{width:"25%"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Bên nhận")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"receiving"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{prop:"receiving",placeholder:"Bên nhận"},model:{value:t.dataBody.receiving,callback:function(e){t.$set(t.dataBody,"receiving",e)},expression:"dataBody.receiving"}})],1)],1),e("div",{staticStyle:{width:"25%","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("SĐT"))]),e("el-form-item",{attrs:{prop:"phone"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"SĐT"},model:{value:t.dataBody.phone,callback:function(e){t.$set(t.dataBody,"phone",e)},expression:"dataBody.phone"}})],1)],1),e("div",{staticStyle:{flex:"1","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Địa chỉ"))]),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"Địa chỉ"},model:{value:t.dataBody.address,callback:function(e){t.$set(t.dataBody,"address",e)},expression:"dataBody.address"}})],1)]),e("div",{staticStyle:{"margin-top":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Ghi chú"))]),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"Ghi chú"},model:{value:t.dataBody.noted,callback:function(e){t.$set(t.dataBody,"noted",e)},expression:"dataBody.noted"}})],1)])]),e("div",[e("h5",[t._v("Thông tin hàng hóa")]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{label:"Mã sản phẩm",align:"center",width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0,placeholder:"Mã sản phẩm"},model:{value:a.row.product_code,callback:function(e){t.$set(a.row,"product_code",e)},expression:"scope.row.product_code"}},[e("template",{slot:"append"},[e("el-button",{staticStyle:{padding:"0px"},attrs:{icon:"el-icon-document"},on:{click:function(e){return t.copyClipboard(a.row.product_code)}}})],1)],2)]}}])}),e("el-table-column",{attrs:{label:"Tên sản phẩm",align:"center",type:"index",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:a.row.name,callback:function(e){t.$set(a.row,"name",e)},expression:"scope.row.name"}})]}}])}),e("el-table-column",{attrs:{label:"Mã hàng NCC",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:o.product_code_shop,callback:function(e){t.$set(o,"product_code_shop",e)},expression:"row.product_code_shop"}})]}}])}),e("el-table-column",{attrs:{label:"Đơn vị tính",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:o.unit,callback:function(e){t.$set(o,"unit",e)},expression:"row.unit"}})]}}])}),e("el-table-column",{attrs:{label:"Số lượng",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:o.origin_number,callback:function(e){t.$set(o,"origin_number",e)},expression:"row.origin_number"}})]}}])}),e("el-table-column",{attrs:{label:"Giá nhập",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{value:o.price?t.formatNumber(o.price):null,disabled:!0}})]}}])}),e("el-table-column",{attrs:{label:"Thành tiền",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{value:o.origin_number&&o.price?t.formatNumber(o.origin_number*o.price):null,disabled:!0}})]}}])}),e("el-table-column",{attrs:{prop:"category",label:"Thuộc tính 1",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:o.param_first,callback:function(e){t.$set(o,"param_first",e)},expression:"row.param_first"}})]}}])}),e("el-table-column",{attrs:{prop:"category",label:"Thuộc tính 2",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:o.param_second,callback:function(e){t.$set(o,"param_second",e)},expression:"row.param_second"}})]}}])}),e("el-table-column",{attrs:{label:"Hành động",align:"center",width:"130px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(e){return t.onEditRow(a.row)}}}),e("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.onDeleteRow(a.row)}}})]}}])})],1),e("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",icon:"el-icon-plus",plain:""},on:{click:t.onAddRow}},[t._v("Thêm sản phẩm")]),e("hr"),e("div",{staticStyle:{display:"flex","justify-content":"end"}},[e("p",{staticStyle:{"font-weight":"500",color:"blue","font-size":"medium","margin-right":"30px"}},[t._v("Tổng tiền: "),e("span",{staticStyle:{color:"gray"}},[t._v(t._s(t.formatNumber(t.totalMoneyNote))+" VND")])])]),e("div",{staticStyle:{display:"flex","justify-content":"right","margin-right":"30px"}},[e("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",plain:""},on:{click:t.handleClose}},[t._v("Hủy")]),e("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:t.onSaveNote}},[t._v("Lưu")])],1)],1)],1)},B=[],N=(a("a9e3"),a("159b"),a("c740"),function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{modal:!1,visible:t.dialogFormVisible,"before-close":t.handleClose,width:"50%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[e("h5",{staticStyle:{color:"#424147","margin-bottom":"30px"}},[t._v("Thông tin hàng hóa")]),e("el-form",{ref:"ruleForm",attrs:{rules:t.rules,model:t.form}},[e("div",{},[e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e("div",{staticClass:"div-product"},[e("label",{staticClass:"item-label"},[t._v(t._s("Mã sản phẩm")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"product_code"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0,prop:"product_code",placeholder:""},model:{value:t.dataBody.product_code,callback:function(e){t.$set(t.dataBody,"product_code",e)},expression:"dataBody.product_code"}})],1)],1),e("div",{staticClass:"div-product"},[e("label",{staticClass:"item-label"},[t._v(t._s("Tên sản phẩm")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"product_code"}},[e("el-select",{staticStyle:{"margin-top":"10px",width:"100%"},attrs:{filterable:"",disabled:t.checkDisabledProduct,remote:"","reserve-keyword":"",placeholder:"Nhập để tìm kiếm","remote-method":t.remoteMethodProduct,loading:t.loadingNameProduct},on:{change:t.onChangeProduct},model:{value:t.dataBody.product_code,callback:function(e){t.$set(t.dataBody,"product_code",e)},expression:"dataBody.product_code"}},t._l(t.optionAllProduct,(function(t){return e("el-option",{key:t.id,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("div",{staticClass:"div-product"},[e("label",{staticClass:"item-label"},[t._v(t._s("Mã hàng NCC"))]),e("el-form-item",{attrs:{prop:"product_code_shop"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{prop:"product_code_shop",disabled:!0},model:{value:t.dataBody.product_code_shop,callback:function(e){t.$set(t.dataBody,"product_code_shop",e)},expression:"dataBody.product_code_shop"}})],1)],1)]),e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e("div",{staticClass:"div-product"},[e("label",{staticClass:"item-label"},[t._v(t._s("Đơn vị tính")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"unit"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"Nhập đơn vị tính",prop:"unit"},model:{value:t.dataBody.unit,callback:function(e){t.$set(t.dataBody,"unit",e)},expression:"dataBody.unit"}})],1)],1),e("div",{staticClass:"div-product"},[e("label",{staticClass:"item-label"},[t._v(t._s("Số lượng")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"origin_number"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{prop:"origin_number",placeholder:"Nhập số lượng"},model:{value:t.dataBody.origin_number,callback:function(e){t.$set(t.dataBody,"origin_number",e)},expression:"dataBody.origin_number"}})],1)],1),e("div",{staticClass:"div-product"},[e("label",{staticClass:"item-label"},[t._v(t._s("Giá nhập")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"price"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{value:t.dataBody.price?t.formatNumber(t.dataBody.price):null,prop:"price",placeholder:"Giá nhập",disabled:!0}})],1)],1)]),e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e("div",{staticClass:"div-product"},[e("label",{staticClass:"item-label"},[t._v(t._s("Thành tiền")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{value:t.dataBody.origin_number&&t.dataBody.price?t.formatNumber(t.dataBody.origin_number*t.dataBody.price):null,prop:"cost",placeholder:"Giá thành tiền",disabled:!0}})],1)],1),e("div",{staticClass:"div-product"},[e("label",{staticClass:"item-label"},[t._v(t._s("Thuộc tính 1"))]),e("el-select",{staticStyle:{"margin-top":"10px",width:"100%"},attrs:{placeholder:"Chọn thuộc tính 1"},model:{value:t.dataBody.param_first,callback:function(e){t.$set(t.dataBody,"param_first",e)},expression:"dataBody.param_first"}},t._l(t.dataBody.list_attr1,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),e("div",{staticClass:"div-product"},[e("label",{staticClass:"item-label"},[t._v(t._s("Thuộc tính 2"))]),e("el-select",{staticStyle:{"margin-top":"10px",width:"100%"},attrs:{placeholder:"Chọn thuộc tính 2"},model:{value:t.dataBody.param_second,callback:function(e){t.$set(t.dataBody,"param_second",e)},expression:"dataBody.param_second"}},t._l(t.dataBody.list_attr2,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1)])])]),e("div",{staticStyle:{display:"flex","justify-content":"right","margin-right":"30px","margin-top":"20px"}},[e("el-button",{attrs:{plain:"",type:"primary"},on:{click:t.handleClose}},[t._v("Hủy")]),e("el-button",{attrs:{type:"primary"},on:{click:t.confirmHandle}},[t._v("Lưu")])],1)],1)}),k=[],D=a("5530"),T=new p["a"],C={props:{dialogFormVisible:{type:Boolean,default:!1},dataBodyOld:{type:Object,default:function(){return{}}},type:{type:Number,default:0},warehouseId:{type:Number,default:null}},data:function(){var t=this;return{rules:{product_code:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.product_code,o,"Mã sản phẩm")},trigger:"change"}],product_name:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.product_code,o,"Tên sản phẩm")},trigger:"change"}],unit:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.unit,o,"Đơn vị tính")},trigger:"change"}],origin_number:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.origin_number,o,"Số lượng")},trigger:"change"}],price:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.price,o,"Giá nhập")},trigger:"change"}],cost:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.cost,o,"Thành tiền")},trigger:"change"}]},form:{},listQueryProduct:{page:1,limit:10,q:""},loadingNameProduct:!1,dataBody:{},allParamFirst:[]}},computed:{checkDisabledProduct:function(){return 1===this.type}},created:function(){this.dataBody=Object(D["a"])({},this.dataBodyOld),console.log(this.dataBodyOld,"dataBodyOld")},mounted:function(){1===this.type&&this.remoteMethodProduct(this.dataBody.name),console.log(this.dataBody,"dataBody")},methods:{formatNumber:y["k"],format_product_params:m["a"],handleClose:function(){this.$emit("on-close")},onSubmitForm:function(t){var e=this;return Object(d["a"])(Object(c["a"])().mark((function a(){return Object(c["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:console.log(e.dataBody,"dataBody"),e.$refs[t].validate(function(){var t=Object(d["a"])(Object(c["a"])().mark((function t(a){return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a&&(0===e.type?e.onAddProduct():e.onEditProduct());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return a.stop()}}),a)})))()},emitParent:function(){0===this.type?this.$emit("on-add",this.dataBody):this.$emit("on-edit",this.dataBody)},onChangeProduct:function(t){var e=this.optionAllProduct.find((function(e){return e.value===t}));if(e){this.dataBody.product_id=e.id,this.dataBody.product_code_shop=e.product_code_shop,this.dataBody.name=e.label,this.allParamFirst=e.params;var a=this.format_product_params(this.allParamFirst),o=a.list_attr1,i=a.list_attr2;this.dataBody.list_attr1=o,this.dataBody.list_attr2=i,console.log(e,"onChangeProduct")}},remoteMethodProduct:function(t){""!==t?(this.listQueryProduct.q=t,1===this.type?this.requestListProductFail():this.requestListProduct()):this.options=[]},onAddProduct:function(){var t=this;T.add_product_to_warehouse({warehouse_id:this.warehouseId,product:this.dataBody}).then((function(e){var a=e.error,o=e.msg;0===a?(t.$message.success(o),t.emitParent(),t.handleClose()):t.$message.error(o)})).catch((function(e){t.$message.error(e.message)}))},onEditProduct:function(){var t=this,e={id:this.dataBody.id,product_id:this.dataBody.product_id,price:parseInt(this.dataBody.price),cost:parseInt(this.dataBody.price*this.dataBody.origin_number),unit:this.dataBody.unit,origin_number:parseInt(this.dataBody.origin_number),param_first:this.dataBody.param_first,param_second:this.dataBody.param_second};T.edit_product_to_warehouse({warehouse_id:this.warehouseId},e).then((function(e){var a=e.error,o=e.msg;0===a?(t.$message.success(o),t.emitParent(),t.handleClose()):t.$message.error(o)})).catch((function(e){t.$message.error(e.message)}))},requestListProductFail2nd:function(){var t=this;this.loadingNameProduct=!0,this.listQueryProduct.q=this.dataBody.product_code_shop,T.list_product(this.listQueryProduct).then((function(e){var a=e.error,o=e.list;if(0!==a)throw new Error("Không lấy được danh sách sản phẩm 2nd");t.optionAllProduct=o.map((function(t){return{id:t.id,value:t.product_code,product_code_shop:t.product_code_shop,label:t.name,params:t.params}})),t.onChangeProduct(t.dataBody.product_code)})).catch((function(e){t.$message.error(e.message)})).finally((function(){t.loadingNameProduct=!1}))},requestListProductFail:function(){var t=this;this.loadingNameProduct=!0,this.listQueryProduct.q=this.dataBody.product_code,1===this.type&&(this.listQueryProduct.filter=1),T.list_product(this.listQueryProduct).then((function(e){var a=e.error,o=e.list;if(0!==a)throw new Error("Không lấy được danh sách sản phẩm");if(0===o.length)throw new Error("Không tìm thấy sản phẩm");t.optionAllProduct=o.map((function(t){return{id:t.id,value:t.product_code,product_code_shop:t.product_code_shop,label:t.name,params:t.params}})),t.onChangeProduct(t.dataBody.product_code)})).catch((function(e){console.log(e,"error"),t.$message.error(e.message)})).finally((function(){t.loadingNameProduct=!1}))},requestListProduct:function(){var t=this;this.loadingNameProduct=!0,T.list_product(this.listQueryProduct).then((function(e){var a=e.error,o=e.list;if(0!==a)throw new Error("Không lấy được danh sách sản phẩm");t.optionAllProduct=o.map((function(t){return{id:t.id,value:t.product_code,product_code_shop:t.product_code_shop,label:t.name,params:t.params}})),t.onChangeProduct(t.dataBody.product_code)})).catch((function(e){console.log(e,"error"),t.$message.error(e.message)})).finally((function(){t.loadingNameProduct=!1}))},onSelectAttr1:function(t){var e=this.allParamFirst.find((function(e){return e.id===t}));this.dataBody.param_first=e.param_first,this.dataBody.param_second=e.param_second,console.log(this.dataBody,"dataBody")},confirmHandle:function(){var t=this;1===this.type?this.$confirm("Bạn có chắc muốn sửa sản phẩm?","Warning",{confirmButtonText:"Lưu",cancelButtonText:"Hủy",type:"warning"}).then((function(){t.onSubmitForm("ruleForm")})):this.$confirm("Bạn có chắc muốn thêm sản phẩm?","Warning",{confirmButtonText:"Thêm",cancelButtonText:"Hủy",type:"warning"}).then((function(){t.onSubmitForm("ruleForm")}))}}},$=C,P=(a("2403"),Object(_["a"])($,N,k,!1,null,"745ea0f5",null)),j=P.exports,O=new p["a"];u["default"].config.warnHandler=function(t,e,a){};var E={name:"DialogAddReceivedNote",components:{editTableNote:j},props:{showDetail:{type:Boolean,default:!1},id:{type:Number,default:0}},data:function(){var t=this;return{objData:{},dataEditRow:{},rules:{receiving:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.receiving,o,"Bên nhận")},trigger:"change"}],purpose:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.purpose,o,"Tên phiếu xuất kho")},trigger:"change"}],phone:[{required:!1,validator:function(e,a,o){return Object(h["o"])(e,t.dataBody.phone,o,"Số điện thoại")},trigger:"change"}],dateDeliveryNote:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.import_time,o,"Ngày xuất kho")},trigger:"change"}]},typeHandleDialog:null,tableData:[{}],loading:!1,dateReceivedNote:"",selectShop:null,optionShop:[],dataBody:{name:null,purpose:null,import_time:null,shop_id:null,noted:null,address:null,list_product:null,type:0},listQueryProduct:{page:1,limit:10,q:""},loadingNameProduct:!1,optionAllProduct:[],showEditTableNote:!1,dataUpdate:{}}},computed:{note_code:function(){return"XK"+this.dataBody.id},totalMoneyNote:function(){var t=this.tableData.reduce((function(t,e){return e.origin_number&&e.price?t+e.origin_number*e.price:t}),0);return t||0}},watch:{dateReceivedNote:function(t){var e=new Date(t),a=e.getTime();this.dataBody.import_time=a},selectShop:function(t){console.log("selectShop",t),this.dataBody.shop_id=t}},mounted:function(){console.log(this.id,"this.id"),this.getEditNoteInfo(),this.listAllShop()},methods:{formatNumber:y["k"],copyClipboard:f["a"],onSubmitForm:function(t){var e=this;return Object(d["a"])(Object(c["a"])().mark((function a(){return Object(c["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.dataBody.name=e.dataBody.purpose,e.$refs[t].validate(function(){var t=Object(d["a"])(Object(c["a"])().mark((function t(a){return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a&&(e.dataUpdate={id:e.id,address:e.dataBody.address,purpose:e.dataBody.purpose,import_time:e.dataBody.import_time,name:e.dataBody.name,noted:e.dataBody.noted,shop_id:e.dataBody.shop_id},e.editDeliveryNote());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return a.stop()}}),a)})))()},handleClose:function(){this.$emit("close-dialog")},onDeleteRow:function(t){var e=this;this.$confirm("Bạn có chắc muốn xóa sản phẩm?","Warning",{confirmButtonText:"Thêm",cancelButtonText:"Hủy",type:"warning"}).then((function(){console.log(t,"row delete"),O.delete_product_to_warehouse({warehouse_id:e.id,product_id:t.product_id}).then((function(a){var o=a.error;if(0!==o)throw new Error("Xóa sản phẩm thất bại");e.$message.success("Xóa sản phẩm thành công"),e.tableData=e.tableData.filter((function(e){return e!==t})),console.log(e.tableData,"this.tableData")})).catch((function(t){console.log("..........deleteProduct ",t),e.$message.error(t.message)}))}))},onEditRow:function(t){this.typeHandleDialog=1,this.dataEditRow=t,this.showEditTableNote=!0},onAddRow:function(){this.typeHandleDialog=0,this.dataEditRow={},this.showEditTableNote=!0},editDeliveryNote:function(){var t=this;O.edit_warehouse_note(this.dataUpdate).then((function(e){var a=e.error,o=e.data;if(console.log("..........editDeliveryNote ",JSON.stringify(o)),0!==a)throw new Error("Cập nhật phiếu nhập kho thất bại");t.$message.success("Cập nhật phiếu nhập kho thành công"),t.$emit("success-edit-note"),t.handleClose()})).catch((function(e){console.log("..........editDeliveryNote ",e),t.$message.error(e.message)})),console.log("editDeliveryNote")},listAllShop:function(){var t=this;O.list_shop_all().then((function(e){var a=e.error,o=e.list;if(0!==a)throw new Error("Không lấy được danh sách cửa hàng");t.optionShop=o.map((function(t){return{value:t.id,label:t.name}}))})).catch((function(e){console.log("..........listShopAll ",e),t.$message.error(e.message)}))},onSaveNote:function(){this.onSubmitForm("ruleForm"),console.log("onSaveNote"),console.log("this.dataBody",this.dataBody)},remoteMethodProduct:function(t){""!==t?this.listQueryProduct.q=t:this.options=[]},onChangeProduct:function(t){console.log("onChangeProduct",t);var e=this.optionAllProduct.find((function(e){return e.value===t.product_code}));e&&(t.product_id=e.id)},getEditNoteInfo:function(){var t=this;O.detail_warehouse_note({warehouse_id:this.id}).then((function(e){var a=e.error,o=e.data;if(0!==a)throw new Error("Không lấy được thông tin phiếu nhập kho");t.dataBody=o,t.selectShop=o.shop_id,t.dateReceivedNote=o.import_time.split(" ")[0],t.tableData=o.list_product,t.tableData.forEach((function(e){console.log(e,"item"),t.remoteMethodProduct(e.name)})),console.log("..........getEditNoteInfo ",t.dataBody)})).catch((function(e){console.log("..........getEditNoteInfo ",e),t.$message.error(e.message)}))},addRowNote:function(t){console.log("addRowNote",t),this.tableData.push(t),this.showEditTableNote=!1},editRowNote:function(t){var e=this.tableData.findIndex((function(e){return e.product_id===t.product_id}));this.$set(this.tableData,e,t),this.showEditTableNote=!1}}},q=E,R=(a("29c9"),Object(_["a"])(q,S,B,!1,null,"2cdeeb98",null)),A=R.exports,M=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.showDetail,"before-close":t.handleClose,top:"1vh",width:"90%"},on:{"update:visible":function(e){t.showDetail=e}}},[e("el-form",{ref:"ruleForm",staticStyle:{"margin-bottom":"40px"},attrs:{rules:t.rules,model:t.objData}},[e("h5",{staticStyle:{color:"black"}},[t._v("THÔNG TIN PHIẾU NHẬP KHO")]),e("div",{staticStyle:{border:"1px solid gainsboro",padding:"30px 20px","margin-top":"20px"}},[e("div",{staticStyle:{display:"flex","justify-content":"left"}},[e("div",{staticStyle:{width:"25%"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Mã phiếu nhập"))]),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:t.note_code,callback:function(e){t.note_code=e},expression:"note_code"}})],1),e("div",{staticStyle:{width:"25%","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Ngày xuất kho")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"dateReceivedNote"}},[e("el-date-picker",{staticStyle:{"margin-top":"10px",width:"100%"},attrs:{type:"date",disabled:!0,prop:"dateReceivedNote",placeholder:""},model:{value:t.dateReceivedNote,callback:function(e){t.dateReceivedNote=e},expression:"dateReceivedNote"}})],1)],1),e("div",{staticStyle:{flex:"1","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Tên phiếu xuất kho")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"name"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{prop:"name",disabled:!0},model:{value:t.dataBody.purpose,callback:function(e){t.$set(t.dataBody,"purpose",e)},expression:"dataBody.purpose"}})],1)],1)]),e("div",{staticStyle:{display:"flex","justify-content":"left","margin-top":"20px"}},[e("div",{staticStyle:{width:"25%"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Bên nhận")),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("el-form-item",{attrs:{prop:"receiving"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{prop:"receiving",disabled:!0,placeholder:"Bên nhận"},model:{value:t.dataBody.receiving,callback:function(e){t.$set(t.dataBody,"receiving",e)},expression:"dataBody.receiving"}})],1)],1),e("div",{staticStyle:{width:"25%","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("SĐT"))]),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0,placeholder:"SĐT"},model:{value:t.dataBody.phone,callback:function(e){t.$set(t.dataBody,"phone",e)},expression:"dataBody.phone"}})],1),e("div",{staticStyle:{flex:"1","margin-left":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Địa chỉ"))]),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0,placeholder:"Địa chỉ"},model:{value:t.dataBody.address,callback:function(e){t.$set(t.dataBody,"address",e)},expression:"dataBody.address"}})],1)]),e("div",{staticStyle:{"margin-top":"20px"}},[e("label",{staticClass:"item-label"},[t._v(t._s("Ghi chú"))]),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0,placeholder:"Ghi chú"},model:{value:t.dataBody.noted,callback:function(e){t.$set(t.dataBody,"noted",e)},expression:"dataBody.noted"}})],1)])]),e("div",[e("h5",[t._v("Thông tin hàng hóa")]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{label:"Mã sản phẩm",align:"center",width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0,placeholder:"Mã sản phẩm"},model:{value:a.row.product_code,callback:function(e){t.$set(a.row,"product_code",e)},expression:"scope.row.product_code"}},[e("template",{slot:"append"},[e("el-button",{staticStyle:{padding:"0px"},attrs:{icon:"el-icon-document"},on:{click:function(e){return t.copyClipboard(a.row.product_code)}}})],1)],2)]}}])}),e("el-table-column",{attrs:{label:"Tên sản phẩm",align:"center",type:"index",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:a.row.name,callback:function(e){t.$set(a.row,"name",e)},expression:"scope.row.name"}})]}}])}),e("el-table-column",{attrs:{label:"Mã hàng NCC",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:o.product_code_shop,callback:function(e){t.$set(o,"product_code_shop",e)},expression:"row.product_code_shop"}})]}}])}),e("el-table-column",{attrs:{label:"Đơn vị tính",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:o.unit,callback:function(e){t.$set(o,"unit",e)},expression:"row.unit"}})]}}])}),e("el-table-column",{attrs:{label:"Số lượng",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:o.origin_number,callback:function(e){t.$set(o,"origin_number",e)},expression:"row.origin_number"}})]}}])}),e("el-table-column",{attrs:{label:"Giá nhập",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{value:(o.price,t.formatNumber(o.price)),disabled:!0}})]}}])}),e("el-table-column",{attrs:{label:"Thành tiền",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{value:o.origin_number&&o.price?t.formatNumber(o.origin_number*o.price):t.formatNumber(o.cost),disabled:!0}})]}}])}),e("el-table-column",{attrs:{prop:"category",label:"Thuộc tính 1",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:o.param_first,callback:function(e){t.$set(o,"param_first",e)},expression:"row.param_first"}})]}}])}),e("el-table-column",{attrs:{prop:"category",label:"Thuộc tính 2",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){var o=a.row;return[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{disabled:!0},model:{value:o.param_second,callback:function(e){t.$set(o,"param_second",e)},expression:"row.param_second"}})]}}])})],1),e("hr"),e("div",{staticStyle:{display:"flex","justify-content":"end"}},[e("p",{staticStyle:{"font-weight":"500",color:"blue","font-size":"medium","margin-right":"30px"}},[t._v("Tổng tiền: "),e("span",{staticStyle:{color:"gray"}},[t._v(t._s(t.formatNumber(t.totalMoneyNote))+" VND")])])])],1)],1)},F=[],H=new p["a"];u["default"].config.warnHandler=function(t,e,a){};var Q={name:"DialogAddReceivedNote",props:{showDetail:{type:Boolean,default:!1},id:{type:Number,default:0}},data:function(){var t=this;return{objData:{},dataEditRow:{},rules:{receiving:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.receiving,o,"Bên nhận")},trigger:"change"}],purpose:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.purpose,o,"Tên phiếu xuất kho")},trigger:"change"}],dateDeliveryNote:[{required:!0,validator:function(e,a,o){return Object(h["q"])(e,t.dataBody.import_time,o,"Ngày xuất kho")},trigger:"change"}]},typeHandleDialog:null,tableData:[{}],loading:!1,dateReceivedNote:"",selectShop:null,optionShop:[],dataBody:{name:null,purpose:null,import_time:null,shop_id:null,noted:null,address:null,list_product:null,type:0},listQueryProduct:{page:1,limit:10,q:""},loadingNameProduct:!1,optionAllProduct:[],showEditTableNote:!1,dataUpdate:{}}},computed:{note_code:function(){return"XK"+this.dataBody.id},totalMoneyNote:function(){var t=this.tableData.reduce((function(t,e){return e.origin_number&&e.price?t+e.origin_number*e.price:t}),0),e=this.tableData.reduce((function(t,e){return e.cost?t+e.cost:t}),0);return t||e}},watch:{dateReceivedNote:function(t){var e=new Date(t),a=e.getTime();this.dataBody.import_time=a},selectShop:function(t){console.log("selectShop",t),this.dataBody.shop_id=t}},mounted:function(){console.log(this.id,"this.id"),this.getEditNoteInfo(),this.listAllShop()},methods:{formatNumber:y["k"],copyClipboard:f["a"],onSubmitForm:function(t){var e=this;return Object(d["a"])(Object(c["a"])().mark((function a(){return Object(c["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.dataBody.name=e.dataBody.purpose,e.$refs[t].validate(function(){var t=Object(d["a"])(Object(c["a"])().mark((function t(a){return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a&&(e.dataUpdate={id:e.id,address:e.dataBody.address,purpose:e.dataBody.purpose,import_time:e.dataBody.import_time,name:e.dataBody.name,noted:e.dataBody.noted,shop_id:e.dataBody.shop_id},e.editDeliveryNote());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return a.stop()}}),a)})))()},handleClose:function(){this.$emit("close-dialog")},onDeleteRow:function(t){var e=this;this.$confirm("Bạn có chắc muốn xóa sản phẩm?","Warning",{confirmButtonText:"Thêm",cancelButtonText:"Hủy",type:"warning"}).then((function(){console.log(t,"row delete"),H.delete_product_to_warehouse({warehouse_id:e.id,product_id:t.product_id}).then((function(a){var o=a.error;if(0!==o)throw new Error("Xóa sản phẩm thất bại");e.$message.success("Xóa sản phẩm thành công"),e.tableData=e.tableData.filter((function(e){return e!==t})),console.log(e.tableData,"this.tableData")})).catch((function(t){console.log("..........deleteProduct ",t),e.$message.error(t.message)}))}))},onEditRow:function(t){this.typeHandleDialog=1,this.dataEditRow=t,this.showEditTableNote=!0},onAddRow:function(){this.typeHandleDialog=0,this.dataEditRow={},this.showEditTableNote=!0},editDeliveryNote:function(){var t=this;H.edit_warehouse_note(this.dataUpdate).then((function(e){var a=e.error,o=e.data;if(console.log("..........editDeliveryNote ",JSON.stringify(o)),0!==a)throw new Error("Cập nhật phiếu nhập kho thất bại");t.$message.success("Cập nhật phiếu nhập kho thành công"),t.$emit("success-edit-note"),t.handleClose()})).catch((function(e){console.log("..........editDeliveryNote ",e),t.$message.error(e.message)})),console.log("editDeliveryNote")},listAllShop:function(){var t=this;H.list_shop_all().then((function(e){var a=e.error,o=e.list;if(0!==a)throw new Error("Không lấy được danh sách cửa hàng");t.optionShop=o.map((function(t){return{value:t.id,label:t.name}}))})).catch((function(e){console.log("..........listShopAll ",e),t.$message.error(e.message)}))},onSaveNote:function(){this.onSubmitForm("ruleForm"),console.log("onSaveNote"),console.log("this.dataBody",this.dataBody)},remoteMethodProduct:function(t){""!==t?this.listQueryProduct.q=t:this.options=[]},onChangeProduct:function(t){console.log("onChangeProduct",t);var e=this.optionAllProduct.find((function(e){return e.value===t.product_code}));e&&(t.product_id=e.id)},getEditNoteInfo:function(){var t=this;H.detail_warehouse_note({warehouse_id:this.id}).then((function(e){var a=e.error,o=e.data;if(0!==a)throw new Error("Không lấy được thông tin phiếu nhập kho");t.dataBody=o,t.selectShop=o.shop_id,t.dateReceivedNote=o.import_time?o.import_time.split(" ")[0]:o.export_time.split(" ")[0],t.tableData=o.list_product,t.tableData.forEach((function(e){console.log(e,"item"),t.remoteMethodProduct(e.name)})),console.log("..........getEditNoteInfo ",t.dataBody)})).catch((function(e){console.log("..........getEditNoteInfo ",e),t.$message.error(e.message)}))},addRowNote:function(t){console.log("addRowNote",t),this.tableData.push(t),this.showEditTableNote=!1},editRowNote:function(t){var e=this.tableData.findIndex((function(e){return e.product_id===t.product_id}));this.$set(this.tableData,e,t),this.showEditTableNote=!1}}},I=Q,G=(a("a3af"),Object(_["a"])(I,M,F,!1,null,"0061139f",null)),L=G.exports,K=a("fa7d"),V=a("5f87"),U=new p["a"],X={components:{Pagination:r["a"],addDeliveryNote:x,editDeliveryNote:A,viewDeliveryNote:L},data:function(){return{dateRange:"",listQuery:{page:1,limit:10,type:1,q:""},searchString:"",filterSearch:2,searchOption:[{id:2,name:"Tìm theo tên phiếu xuất"},{id:1,name:"Tìm theo mã phiếu xuất"}],loading:!1,tableData:[],total:0,showDialogAddDeliveryNote:!1,showDialogEditDeliveryNote:!1,showDialogViewDeliveryNote:!1,edit_id:null,view_id:null,tabName:"first"}},mounted:function(){this.requestListPermissionMenu()},methods:{onBack:function(){window.history.back()},formatNumber:y["k"],requestListPermissionMenu:function(){var t=this,e=this.$router.history.current.meta.roles,a=e&&e.length?e[0]:0;a=parseInt(a.replace("NCC",""));var o=Object(V["a"])(),i=o.email;Object(K["a"])(i,a,(function(e){if(console.log("............list data 1",JSON.stringify(e)),e){var a=e.is_supper_admin,o=e.is_add,i=e.is_view,n=e.is_edit,r=e.is_delete,l=e.is_export;a=parseInt(a)||0,o=parseInt(o)||1,i=parseInt(i)||1,n=parseInt(n)||1,r=parseInt(r)||1,l=parseInt(l)||1,t.is_delete=a?1:r-1,t.is_write=a?1:o-1,t.is_edit=a?1:n-1,t.is_export=a?1:l-1,t.is_view=a?1:i-1,t.getTableData()}}))},handleChangeDateRange:function(t){var e=new Date(t[0]),a=new Date(t[1]);this.listQuery.page=1,this.listQuery.date_from=e.getTime(),this.listQuery.date_to=a.getTime(),this.getTableData()},resetFilter:function(){this.dateRange="",this.searchString="",this.listQuery.page=1,this.listQuery.date_from="",this.listQuery.date_to="",this.filterSearch=2,this.listQuery.q="",this.listQuery.type_search=2,this.getTableData()},getTableData:function(){var t=this;this.loading=!0,U.list_warehouse_received_note(this.listQuery).then((function(e){var a=e.error,o=e.data;if(0!==a)throw new Error("Lỗi lấy dữ liệu");1===t.listQuery.page&&(t.total=e.total),t.tableData=o})).catch((function(e){console.log(e),t.$message.error(e.message)})).finally((function(){t.loading=!1}))},handleEdit:function(t){this.showDialogEditDeliveryNote=!0,this.edit_id=t.id},handleView:function(t){this.showDialogViewDeliveryNote=!0,this.view_id=t.id},deleteWarehouseNote:function(t){var e=this;this.loading=!0,U.delete_warehouse_note(t).then((function(t){var a=t.error;if(0!==a)throw new Error("Lỗi xóa phiếu xuất");e.$message.success("Xóa phiếu xuất thành công"),e.loading=!1,e.getTableData()})).catch((function(t){console.log(t),e.$message.error(t.message),e.loading=!1}))},handleDelete:function(t){var e=this;this.$confirm("Bạn có chắc muốn xóa phiếu xuất này?","Warning",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"}).then((function(){e.deleteWarehouseNote({warehouse_id:t.id})}))},onAddReceivedNote:function(){this.showDialogAddDeliveryNote=!0},handleImportTime:function(t){var e=t.split(" ")[1],a=e.split("/"),o=Object(n["a"])(a,3),i=o[0],r=o[1],l=o[2];return"".concat(l,"-").concat(r.padStart(2,"0"),"-").concat(i.padStart(2,"0"))},handleSuccessEdit:function(){this.getTableData()},handleChangeTab:function(t){this.listQuery.is_cancel="first"===t.name?0:1,this.resetFilter()},onSearchDeliveryNote:function(){this.listQuery.page=1,this.listQuery.type_search=this.filterSearch,this.getTableData()}}},W=X,J=(a("3e48"),Object(_["a"])(W,o,i,!1,null,"4b152f70",null));e["default"]=J.exports},a3af:function(t,e,a){"use strict";a("3f27")},b185:function(t,e,a){"use strict";a("d66d")},c258:function(t,e,a){},d66d:function(t,e,a){},fa7d:function(t,e,a){"use strict";a.d(e,"f",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return l})),a.d(e,"e",(function(){return s})),a.d(e,"g",(function(){return c})),a.d(e,"a",(function(){return d}));a("99af");var o=a("a27e");function i(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setDate(t.getDate()-1);var e=new Date;return e.setHours(23),e.setMinutes(59),e.setSeconds(50),e.setDate(e.getDate()-1),[t.getTime(),e.getTime()]}function n(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0);var e=Date.now();return[t.getTime(),e]}function r(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setDate(1);var e=Date.now();return[t.getTime(),e]}function l(){var t=i(),e=new Date(t[0]);e.setDate(e.getDate()-7);var a=new Date(t[1]);return a.setDate(a.getDate()-7),[e.getTime(),a.getTime()]}function s(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setDate(t.getDate()-7);var e=Date.now();return[t.getTime(),e]}function c(t){return!isNaN(new Date(t))}function d(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{Object(o["a"])({url:"https://shop.vcallid.com/api/public/supplier/get_permisson_menu?email=".concat(t,"&menu_id=").concat(e),method:"get"}).then((function(t){var e=t.error,o=t.data;0===e&&a&&a(o)})).catch((function(t){i&&i(t)}))}catch(n){}}}}]);