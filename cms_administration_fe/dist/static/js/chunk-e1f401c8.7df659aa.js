(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e1f401c8"],{"0538":function(e,t,n){"use strict";var i=n("e330"),r=n("59ed"),o=n("861d"),c=n("1a2d"),a=n("f36a"),s=n("40d5"),u=Function,l=i([].concat),d=i([].join),f={},h=function(e,t,n){if(!c(f,t)){for(var i=[],r=0;r<t;r++)i[r]="a["+r+"]";f[t]=u("C,a","return new C("+d(i,",")+")")}return f[t](e,n)};e.exports=s?u.bind:function(e){var t=r(this),n=t.prototype,i=a(arguments,1),c=function(){var n=l(i,a(arguments));return this instanceof c?h(t,n.length,n):t.apply(e,n)};return o(n)&&(c.prototype=n),c}},"262e":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("d9e2"),n("131a"),n("1f68");function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}},"2caf":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("4ae1"),n("d3b7"),n("f8c9"),n("131a"),n("3410"),n("1f68");function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n("d9e2");var o=n("53ca");function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){if(t&&("object"===Object(o["a"])(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function s(e){var t=r();return function(){var n,r=i(e);if(t){var o=i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a(this,n)}}},"4ae1":function(e,t,n){"use strict";var i=n("23e7"),r=n("d066"),o=n("2ba4"),c=n("0538"),a=n("5087"),s=n("825a"),u=n("861d"),l=n("7c73"),d=n("d039"),f=r("Reflect","construct"),h=Object.prototype,p=[].push,m=d((function(){function e(){}return!(f((function(){}),[],e)instanceof e)})),g=!d((function(){f((function(){}))})),b=m||g;i({target:"Reflect",stat:!0,forced:b,sham:b},{construct:function(e,t){a(e),s(t);var n=arguments.length<3?e:a(arguments[2]);if(g&&!m)return f(e,t,n);if(e===n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var i=[null];return o(p,i,t),new(o(c,e,i))}var r=n.prototype,d=l(u(r)?r:h),b=o(e,d,t);return u(b)?b:d}})},"6c6e":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("d4ec"),r=n("bee2"),o=n("b775"),c=function(){function e(t){Object(i["a"])(this,e),this.uri=t}return Object(r["a"])(e,[{key:"list",value:function(e){return Object(o["a"])({url:"/"+this.uri,method:"get",params:e})}},{key:"get",value:function(e){return Object(o["a"])({url:"/"+this.uri+"/"+e,method:"get"})}},{key:"store",value:function(e){return Object(o["a"])({url:"/"+this.uri,method:"post",data:e})}},{key:"update",value:function(e,t){return Object(o["a"])({url:"/"+this.uri+"/"+e,method:"put",data:t})}},{key:"destroy",value:function(e){return Object(o["a"])({url:"/"+this.uri+"/"+e,method:"delete"})}}]),e}()},7836:function(e,t,n){"use strict";n("c0e8")},"7db0":function(e,t,n){"use strict";var i=n("23e7"),r=n("b727").find,o=n("44d2"),c="find",a=!0;c in[]&&Array(1)[c]((function(){a=!1})),i({target:"Array",proto:!0,forced:a},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),o(c)},a27e:function(e,t,n){"use strict";var i=n("c7eb"),r=n("1da1"),o=(n("d3b7"),n("bc3a")),c=n.n(o),a=n("5c96"),s=n("4360"),u=n("5f87"),l="https://prod-wap-wghn-beta.vcallid.com",d=c.a.create({baseURL:l,headers:{Authorization:Object(u["f"])(),auththor:Object(u["d"])(),"X-Token":Object(u["d"])(),"Access-Control-Allow-Origin":"*"},timeout:18e4});d.interceptors.request.use((function(e){e.headers.Authorization=Object(u["f"])(),e.headers["X-Token"]=Object(u["d"])();var t="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiaWF0IjoxNjc4MzMzNDY4fQ.d5WWQAGWF_TCPkvWa0ieclauQAlLierkNKGDCDfbDk5Cd-X98bLV7usneU2jXEu_cqjbJFerDRCky255aLElQLpxHmn_66tcgbTZqa5GRumTDqO4JOmgWd5vE0zRPx3xdfFPG0fILPEAA2_5bIGc4Mzd_FHMr9hqTKOn4TKxgBsCW0z9KNfO-2xevEP_gFi7xauUkdG5KUbG3UAr4sEr1s9Kfhz7H5F_lyIR99TfqV-45E4x4Av0tao2nxt5Nc16z201zjpd9OaHibpIGI1pcCkwORYQpH5pqoanO9alsYkNwyEPZbMCfenY95pD16GTswQwNlCGVmGHnSkkXF1SkBV4_rWt-J6fX1VGjq61nqr6yGm_JXvK3R_DMUN5GIZ_xC4BE6WOZQcF1SseMJalbBJKdFlRz0DpW4rsblr5Ge7KVI4ugPQFRV5PaEL6y_wx65-K8DyFYWwbFVG_YZJqzt7mVgSVZftx1yTaSYoUoAeD8FJ-zVPupv93ZM3y7Q3ybwvwZBj6KI-R9VuXlsLFWAqt7bWcUMXExhDeENGWMbgwF3YdJzG947_KzSkRsEsXK7ZOUKp7ihE3wLxQIueIyITQfmgvuG-AvtDqiffFfjbTP5e8DOLvloP2keIS1v252nZyr3i9pEBqm10KEmCx0krhQHjz5sdJStIenVtKospeB8tBjSbyCW5t0-RRo8vQOg40Jn-ySKnnBGW_jYMTy3hadbAxAQc4IprphQmvuFuVaO4YK4wNB_dEtbzAYSLpfm9vTk9eX0f95tleguH6QjEG8siA4znsMUf2SLdQNKcTniOEHp5hGcKV0gRX63zIC7X9dClOINwg3wYh6ecyXg";return e.headers.token=t,s["a"].getters.token,e}),(function(e){return Promise.reject(e)})),d.interceptors.response.use(function(){var e=Object(r["a"])(Object(i["a"])().mark((function e(t){var n,r,o,s;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.data,0===n.error_code){e.next=26;break}if(console.log(n.error_code),403!==n.error_code){e.next=6;break}return a["Message"].error(n.error_msg||"Có lỗi xảy ra vui lòng thử lại sau"),e.abrupt("return");case 6:if(498!==n.error_code){e.next=9;break}return f(),e.abrupt("return");case 9:if(401!==n.error_code){e.next=23;break}return r=Object(u["d"])(),e.next=13,d.post("/admin/token",{refresh_token:r});case 13:if(o=e.sent,0!==o.error_code){e.next=22;break}return s=t.config,s._retry=!0,c.a.defaults.headers.common["Authorization"]="Bearer "+o.data.token,Object(u["q"])(o.data.token),e.abrupt("return",d(s));case 22:f();case 23:return e.abrupt("return",n);case 26:return e.abrupt("return",n);case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return a["Message"].error(e.message||"Có lỗi xảy ra vui lòng thử lại sau"),Promise.reject(e)}));var f=function(){a["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){return s["a"].dispatch("user/resetToken").then((function(){return location.reload()}))}))};t["a"]=d},a4be:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("d4ec"),r=n("bee2"),o=n("262e"),c=n("2caf"),a=n("6c6e"),s=n("a27e"),u="https://shop.vcallid.com/api/public",l=function(e){Object(o["a"])(n,e);var t=Object(c["a"])(n);function n(){return Object(i["a"])(this,n),t.call(this,"")}return Object(r["a"])(n,[{key:"listAccount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{page:1,limit:10};return Object(s["a"])({url:u+"/permission/list_account_cms",method:"get",params:e})}},{key:"listPermissionOfAccount",value:function(e){return Object(s["a"])({url:u+"/permission/list_menu",method:"get",params:e})}},{key:"listMenuForAdd",value:function(e){return Object(s["a"])({url:u+"/permission/list_menu_for_add",method:"get",params:e})}},{key:"addMenuToAccount",value:function(e){return Object(s["a"])({url:u+"/permission/add_menu_to_account",method:"post",data:e})}},{key:"changeActiveAccount",value:function(e){return Object(s["a"])({url:u+"/permission/change_active",method:"post",data:e})}},{key:"changeActiveMenu",value:function(e){return Object(s["a"])({url:u+"/permission/change_active_menu",method:"post",data:e})}},{key:"updateSubPermission",value:function(e){return Object(s["a"])({url:u+"/permission/update_permission_menu",method:"post",data:e})}}]),n}(a["a"])},bee2:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("a38e");function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Object(i["a"])(r.key),r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},c0e8:function(e,t,n){},c43b:function(e,t,n){"use strict";n.r(t);n("b0c0");var i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"permission-page"}},[t("el-row",{staticStyle:{display:"ruby",width:"100%",padding:"0px 30px"}},[t("p",{staticStyle:{"margin-right":"10px"},on:{click:e.onBack}},[t("i",{staticClass:"el-icon-back"})]),t("h3",{staticStyle:{"font-size":"26px",display:"inherit"}},[e._v(e._s("Thông tin quyền"))])]),t("div",{staticStyle:{width:"100%",height:"100%",padding:"0px 30px"}},[t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[t("h5",[e._v("Tài khoản: "+e._s(e.accountSelect.name))]),t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"10px"}},[t("el-select",{staticClass:"select1",staticStyle:{width:"250px","margin-right":"10px"},attrs:{placeholder:"Thêm nhóm quyền"},on:{change:e.handleSelectPermission},model:{value:e.menu_add_id,callback:function(t){e.menu_add_id=t},expression:"menu_add_id"}},e._l(e.permissionsOption,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-refresh",loading:e.loading},on:{click:e.onRefreshPress}},[e._v("Làm mới")])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tablePermission,align:"center",border:""}},[t("el-table-column",{attrs:{prop:"id",label:"Id",width:"90",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"Nhóm quyền",width:"170",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"Thiết lập quyền",align:"left"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("div",{staticStyle:{display:"flex","flex-wrap":"wrap","justify-content":"left",width:"100%"}},e._l(n.row.list_sub_permission,(function(i){return t("div",{key:i.key,staticStyle:{width:"30%","margin-left":"2%"}},[t("el-checkbox",{attrs:{"v-model":i.key,label:i.name,checked:i.active},on:{change:function(t){return e.handleChecked(n.row.id,i)}}})],1)})),0)]}}])}),t("el-table-column",{attrs:{label:"Trạng thái",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66"},on:{change:function(t){return e.onChangeActive(n.row)}},model:{value:n.row.active,callback:function(t){e.$set(n.row,"active",t)},expression:"scope.row.active"}})]}}])})],1),e.list_permissions.length?t("div",{staticStyle:{"margin-top":"20px",float:"right"},attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("Hủy bỏ")]),t("el-button",{attrs:{type:"primary",loading:e.loadingSubmit},on:{click:e.submitPermission}},[e._v(e._s("Lưu thay đổi"))])],1):e._e()],1)],1)},r=[],o=n("2909"),c=(n("e9c4"),n("b64b"),n("7db0"),n("d3b7"),n("14d9"),n("159b"),n("498a"),n("99af"),n("a4be")),a=new c["a"],s={name:"EditPermission",data:function(){return{accountSelect:{},tablePermission:[],permissionRender:{},permissionsOption:[],loadingSubmit:!1,loading:!1,list:[],list_old:[],is_change:!1,list_permissions:[],menu_add_id:0}},watch:{list:function(e){console.log("..............handl ",JSON.stringify(e))}},mounted:function(){this.accountSelect=this.$route.params,console.log("qqqqqqqqqqqqqqqq",JSON.stringify(this.accountSelect)),Object.keys(this.accountSelect).length>0?(this.getPermissionAccount(),this.getPermissionAdd()):(this.$message.error("Lỗi khi lấy thông tin tài khoản"),this.onBack())},methods:{onBack:function(){this.$router.back()},onRefreshPress:function(){this.getPermissionAccount()},handleChecked:function(e,t){console.log("...........check all ",e,JSON.stringify(t));var n=t.active,i=t.key,r=n?1:2,o=this.list_permissions.find((function(t){return t.id===e}));if(t.active=!n,o)o[i]=r;else{var c={};c[i]=r,c["id"]=e,this.list_permissions.push(c)}},addPermissionConfirm:function(e){var t=this;this.$confirm("Bạn có chắc thêm nhóm quyền này?",{confirmButtonText:"Xác nhận",cancelButtonText:"Hủy",type:"warning"}).then((function(){t.addPermissionToAccount(e)})).catch((function(){console.log("cancel")}))},handleSelectPermission:function(e){console.log("groupPermission",e),this.addPermissionConfirm(e)},submitPermission:function(){var e=this;console.log("..........list permisison ",JSON.stringify(this.list_permissions)),this.list_permissions.length&&(this.loadingSubmit=!0,this.$confirm("Bạn có chắc muốn lưu lại thay đổi?",{confirmButtonText:"Xác nhận",cancelButtonText:"Hủy",type:"warning"}).then((function(){a.updateSubPermission({account_id:e.accountSelect.id,menus:e.list_permissions}).then((function(t){var n=t.error,i=t.msg;console.log("............cap nhat sub quyen ",JSON.stringify(t)),0===n?(e.list_permissions=[],e.list=[],e.$message.success(i),e.onBack()):e.$message.error(i)})).catch((function(t){console.log(t),e.$message.error("Cập nhật quyền thất bại")})).finally((function(){e.loadingSubmit=!1}))})).catch((function(){console.log("cancel")})))},addPermissionToAccount:function(e){var t=this;a.addMenuToAccount({account_id:this.accountSelect.id,menu_id:e}).then((function(e){var n=e.error;0===n&&(t.menu_add_id=0,t.getPermissionAccount(),t.getPermissionAdd(),t.$message.success("Thêm quyền thành công"))})).catch((function(e){console.log(e),t.$message.error("Lỗi khi thêm quyền")})),console.log("addPermission")},getPermissionAccount:function(){var e=this;this.loading=!0,a.listPermissionOfAccount({account_id:this.accountSelect.id}).then((function(t){console.log("getPermissionAccount: ",JSON.stringify(t)),e.loading=!1;var n=t.error,i=t.data;0===n&&(e.tablePermission=i,e.tablePermission.forEach((function(t){var n=t.is_supper_admin,i=t.is_add,r=t.is_edit,o=t.is_delete,c=t.is_view,a=t.sort_name,s=t.is_export;n=parseInt(n)||0,i=parseInt(i)||0,r=parseInt(r)||0,o=parseInt(o)||0,c=parseInt(c)||0,s=parseInt(s)||0,a=a?a.trim().toLowerCase():"";var u=[];if(n)u.push({key:"is_super_admin",name:"Super admin(Full quyền)",active:!1});else{if(i){var l=i-1;u.push({key:"is_add",name:"Thêm mới "+a,active:l>0})}if(r){var d=r-1;u.push({key:"is_edit",name:"Chỉnh sửa "+a,active:d>0})}if(o){var f=o-1;u.push({key:"is_delete",name:"Xóa "+a,active:f>0})}if(c){var h=c-1;u.push({key:"is_view",name:"Xem danh sách "+a,active:h>0})}if(s){var p=s-1;u.push({key:"is_export",name:"Xuất Excel",active:p>0})}}t.list_sub_permission=u,e.list_old=[],console.log("............ list permission : ",JSON.stringify(u),JSON.stringify(e.list))})))})).catch((function(t){e.loading=!1,console.log(t),e.$message.error("Lỗi khi lấy danh sách quyền")}))},getPermissionAdd:function(){var e=this;a.listMenuForAdd({account_id:this.accountSelect.id}).then((function(t){var n=t.error,i=t.data;console.log(".............list menu add ",JSON.stringify(t)),0===n&&(e.permissionsOption=[{id:0,name:"Thêm nhóm quyền"}].concat(Object(o["a"])(i)),e.permissionsOption.forEach((function(e){e.value=e.id,e.label=e.name})))})).catch((function(e){console.log(e)}))},handleChangeActiveMenu:function(e){var t=this;a.changeActiveMenu({account_id:this.accountSelect.id,id:e.id}).then((function(e){var n=e.error,i=e.msg;0===n?(t.getPermissionAccount(),t.getPermissionAdd(),t.list_permissions=[],t.list=[],t.$message.success(i)):t.$message.error(i)})).catch((function(e){console.log(e),t.$message.error("Lỗi khi thay đổi trạng thái quyền")}))},changeActiveMenuConfirm:function(e){var t=this;console.log(e,"changeActiveMenuConfirm"),this.$confirm("Bạn có chắc muốn thay đổi trạng thái quản lý ".concat(e.sort_name,"?"),{confirmButtonText:"Xác nhận",cancelButtonText:"Hủy",type:"warning"}).then((function(){t.handleChangeActiveMenu(e)})).catch((function(){t.tablePermission.forEach((function(t){t.menu_id===e.menu_id&&(t.active=t.active?0:1)})),console.log("cancel")}))},onChangeActive:function(e){this.changeActiveMenuConfirm(e)},handleClose:function(){this.onBack()}}},u=s,l=(n("7836"),n("2877")),d=Object(l["a"])(u,i,r,!1,null,"30cd39f6",null);t["default"]=d.exports},d4ec:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("d9e2");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},f8c9:function(e,t,n){"use strict";var i=n("23e7"),r=n("da84"),o=n("d44e");i({global:!0},{Reflect:{}}),o(r.Reflect,"Reflect",!0)}}]);