(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-636d6969"],{"49bd":function(t,e,a){},"718a":function(t,e,a){"use strict";a.r(e);a("b0c0");var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"dialog-show-info"},[e("dialog-order-products-vue",{ref:"refDialogOrderProducts",attrs:{"offset-top":t.currentY}}),e("div",{staticStyle:{display:"flex","margin-top":"10px","justify-content":"space-between"}},[e("div",{staticStyle:{display:"flex"}},[e("p",{staticStyle:{"margin-right":"15px"},on:{click:t.onBack}},[e("i",{staticClass:"el-icon-back"})]),e("h3",{staticStyle:{"font-size":"20px",color:"black"}},[t._v("Thống kê nhà cung cấp")])]),e("div",{staticStyle:{display:"flex","flex-direction":"row"}},[e("div",{staticStyle:{"margin-right":"10px"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.handleExportExcel}},[t._v("Xuất Excel")])],1),e("div",[e("el-button",{attrs:{loading:t.loading,icon:"el-icon-refresh"},on:{click:t.onRefresh}},[t._v(t._s("Refresh"))])],1)])]),e("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-top":"10px"}},[e("div",{staticStyle:{"margin-right":"10px",width:"100%"}},[e("el-input",{attrs:{placeholder:"Nhập để tìm kiếm",icon:"search"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearchPressSupplier.apply(null,arguments)}},model:{value:t.listQueryAll.q,callback:function(e){t.$set(t.listQueryAll,"q",e)},expression:"listQueryAll.q"}},[e("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})])],1),e("div",{staticStyle:{display:"flex"}},[e("div",{staticStyle:{width:"180px","margin-right":"10px"}},[e("el-select",{model:{value:t.listQueryAll.type_search,callback:function(e){t.$set(t.listQueryAll,"type_search",e)},expression:"listQueryAll.type_search"}},t._l(t.filters,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),e("div",{staticStyle:{width:"120px","margin-right":"10px"}},[e("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearchPressSupplier.apply(null,arguments)},click:t.onSearchPressSupplier}},[t._v(" Tìm kiếm ")])],1),e("el-date-picker",{staticStyle:{width:"300px","margin-right":"10px"},attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"Đến","start-placeholder":"Ngày tính doanh thu","end-placeholder":"Ngày tính doanh thu"},on:{change:t.handleChangeDateRangeSupplierAll},model:{value:t.dateRangeDebt,callback:function(e){t.dateRangeDebt=e},expression:"dateRangeDebt"}}),e("div",{staticStyle:{width:"200px","margin-left":"10px"}},[e("el-select",{model:{value:t.source_id,callback:function(e){t.source_id=e},expression:"source_id"}},t._l(t.sources,(function(t){return e("el-option",{key:t.id,staticStyle:{width:"100%"},attrs:{label:t.name,value:t.id}})})),1)],1)],1)]),e("el-row",{staticStyle:{"margin-top":"10px"}},[e("el-row",{staticClass:"list-shop__data",staticStyle:{"margin-top":"10px"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableDataSupplierAll,border:""}},[1===t.source_id?e("el-table-column",{attrs:{label:"Mã NCC",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(" NCC ".concat(a.row.shop_info.id?a.row.shop_info.id:a.row.source)))])]}}],null,!1,1044594738)}):t._e(),1===t.source_id?e("el-table-column",{attrs:{prop:"shop_info.name",label:"Tên NCC",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-row",[e("span",{staticClass:"text_nomal"},[t._v(t._s(a.row.shop_info.name))])])]}}],null,!1,2302981254)}):t._e(),2===t.source_id?e("el-table-column",{attrs:{prop:"chanel_name",label:"Kênh bán hàng",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-row",[e("span",{staticClass:"text_nomal"},[t._v(t._s(a.row.shop_info.name))])])]}}],null,!1,2302981254)}):t._e(),e("el-table-column",{attrs:{prop:"total_delivery",label:"Tổng đơn tính doanh thu",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-row",[e("span",{staticClass:"text_nomal"},[t._v(t._s(a.row.total_delivery))])]),e("el-row",[a.row.count_delivered_compare>0?e("span",{staticClass:"text_add"},[t._v(t._s("Tăng".concat(": +",a.row.count_delivered_compare)))]):t._e()]),e("el-row",[a.row.count_delivered_compare>0?e("span",{staticClass:"text_add"},[t._v(t._s("Tỷ lệ".concat(": +",a.row.count_delivered_percen,"%")))]):t._e()]),e("el-row",[a.row.count_delivered_compare<0?e("span",{staticClass:"text_sub"},[t._v(t._s("Giảm".concat(": ",a.row.count_delivered_compare)))]):t._e()]),e("el-row",[a.row.count_delivered_compare<0?e("span",{staticClass:"text_sub"},[t._v(t._s("Tỷ lệ".concat(": -",a.row.count_delivered_percen,"%")))]):t._e()])]}}])}),t._v("> "),e("el-table-column",{attrs:{prop:"all_products",label:"Tổng sản phẩm",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-row",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.onShowAllProductPress(a.row)}}},[t._v(t._s(a.row.all_products))])],1),e("el-row",[a.row.total_product_compare<0?e("span",{staticClass:"text_sub"},[t._v(t._s("giam".concat(": ",a.row.total_product_compare)))]):t._e()]),e("el-row",[a.row.total_product_compare<0?e("span",{staticClass:"text_sub"},[t._v(t._s("ty_le".concat(": -",a.row.total_product_percen,"%")))]):t._e()]),e("el-row",[a.row.total_product_compare>0?e("span",{staticClass:"text_add"},[t._v(t._s("tang".concat(": +",a.row.total_product_compare)))]):t._e()]),e("el-row",[a.row.total_product_compare>0?e("span",{staticClass:"text_add"},[t._v(t._s("ty_le".concat(": +",a.row.total_product_percen,"%")))]):t._e()])]}}])}),e("el-table-column",{attrs:{prop:"all_revenue",label:"Doanh thu",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-row",[e("span",{staticClass:"text_nomal"},[t._v(t._s(t.formatNumber(a.row.all_revenue))+" đ")])]),e("el-row",[a.row.total_price_compare<0?e("span",{staticClass:"text_sub"},[t._v(t._s("giam: ".concat(t.formatNumber(a.row.total_price_compare))))]):t._e()]),e("el-row",[a.row.total_price_compare<0?e("span",{staticClass:"text_sub"},[t._v(t._s("ty_le".concat(": -",a.row.total_price_percen,"%")))]):t._e()]),e("el-row",[a.row.total_price_compare>0?e("span",{staticClass:"text_add"},[t._v(t._s("tang: +".concat(t.formatNumber(a.row.total_price_compare))))]):t._e()]),e("el-row",[a.row.total_price_compare>0?e("span",{staticClass:"text_add"},[t._v(t._s("ty_le".concat(": +",a.row.total_price_percen,"%")))]):t._e()])]}}])}),e("el-table-column",{attrs:{prop:"all_cost",label:"Tổng giá nhập",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-row",[e("span",{staticClass:"text_nomal"},[t._v(t._s(t.formatNumber(a.row.all_cost))+" đ")])])]}}])}),e("el-table-column",{attrs:{prop:"all_refund_point",label:"Tổng hoàn point",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-row",[e("span",{staticClass:"text_nomal"},[t._v(t._s(a.row.all_refund_point))])])]}}])}),e("el-table-column",{attrs:{prop:"all_profit",label:"Lợi nhuận gộp",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-row",[e("span",{staticClass:"text_nomal"},[t._v(t._s(t.formatNumber(a.row.all_profit))+" đ")])]),e("el-row",[a.row.loi_nhuan_compare<0?e("span",{staticClass:"text_sub"},[t._v(t._s("giam: ".concat(t.formatNumber(a.row.loi_nhuan_compare))))]):t._e()]),e("el-row",[a.row.loi_nhuan_compare<0?e("span",{staticClass:"text_sub"},[t._v(t._s("ty_le".concat(": -",a.row.loi_nhuan_percen,"%")))]):t._e()]),e("el-row",[a.row.loi_nhuan_compare>0?e("span",{staticClass:"text_add"},[t._v(t._s("tang: +".concat(t.formatNumber(a.row.loi_nhuan_compare))))]):t._e()]),e("el-row",[a.row.loi_nhuan_compare>0?e("span",{staticClass:"text_add"},[t._v(t._s("ty_le".concat(": +",a.row.loi_nhuan_percen,"%")))]):t._e()])]}}])})],1),e("el-row",[e("pagination",{attrs:{total:t.totalSupplier,limit:t.listQueryAll.limit,page:t.listQueryAll.page},on:{"update:limit":function(e){return t.$set(t.listQueryAll,"limit",e)},"update:page":function(e){return t.$set(t.listQueryAll,"page",e)},pagination:t.getListSupplierAll}})],1)],1)],1)],1)},o=[],r=a("c7eb"),i=a("1da1"),n=(a("99af"),a("d3b7"),a("e9c4"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("88a7"),a("271a"),a("5494"),a("9911"),a("f966")),s=a("cf43"),c=a("333d"),u=a("bcc2"),p=a("fa7d"),d=a("c1df"),_=a.n(d),h=new s["a"],m={components:{Pagination:c["a"],DialogOrderProductsVue:n["a"]},data:function(){return{dialog:{titleName:"Thông tin doanh thu đơn hàng"},tableData:[],tableDataSupplierAll:[],loading:!1,listQuery:{page:1,limit:10},listQueryAll:{page:1,limit:10,type_search:2},total:0,totalSupplier:0,dateRangeProduct:"",dateRangeDebt:"",filters:[{id:1,name:"Tìm theo mã NCC"},{id:2,name:"Tìm theo tên NCC"}],sources:[{id:1,name:"Theo nhà cung cấp"},{id:2,name:"Theo kênh bán hàng"}],source_id:1}},watch:{source_id:function(t){this.getListSupplierAll()}},mounted:function(){var t=Object(p["b"])(),e=t[0],a=t[1];this.listQuery.date_from=t[0],this.listQuery.date_to=t[1],this.dateRangeProduct=[_()(e).format("YYYY-MM-DD"),_()(a).format("YYYY-MM-DD")],this.listQueryAll.date_from=t[0],this.listQueryAll.date_to=t[1],this.dateRangeDebt=[_()(e).format("YYYY-MM-DD"),_()(a).format("YYYY-MM-DD")],this.getListSupplierAll(),window.addEventListener("scroll",this.getCurrentY)},beforeDestroy:function(){window.removeEventListener("scroll",this.getCurrentY)},methods:{formatNumber:u["k"],getCurrentY:function(){this.currentY=window.scrollY},handleClose:function(){this.$emit("closeDialog")},handleImageError:function(t){t.showImage=!1},onShowAllProductPress:function(t){this.$refs.refDialogOrderProducts&&this.$refs.refDialogOrderProducts.show(!0,this.currentY,t.shop_info,this.listQuery,this.source_id)},handleChangeDateRangeSupplierAll:function(t){if(t&&2===t.length){var e=t[0],a=t[1];this.dateRangeText="Thống kê từ ".concat(_()(e).format("DD/MM/YYYY")," đến ").concat(_()(a).format("DD/MM/YYYY"))}var l=new Date(t[0]),o=new Date(t[1]);this.listQueryAll.page=1,this.listQueryAll.date_from=l.getTime(),this.listQueryAll.date_to=o.getTime(),console.log(this.listQueryAll),this.getListSupplierAll()},getListSupplierAll:function(){var t=this;this.listQueryAll.type_statistical=this.source_id,this.loading=!0,h.list_statistical_supplier_for_all(this.listQueryAll).then((function(e){var a=e.error,l=e.data,o=e.msg;console.log(".................. thong ke ",JSON.stringify(e)),0===a?(1===t.listQueryAll.page&&(t.totalSupplier=e.total),t.tableDataSupplierAll=l):t.$message.error(o)})).catch((function(e){t.loading=!1,console.log("........... error",e)})).finally((function(){t.loading=!1}))},confirmDowload:function(t){this.getFileFromServer(t)},getFileFromServer:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function a(){var l,o;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:l=t.substring(t.lastIndexOf("/")+1),o=document.createElement("a"),o.href=t,o.download=l,o.click(),setTimeout((function(){window.URL.revokeObjectURL(t),e.$message.success("Xuất file thành công, vui lòng vào thư mục donwload để xem")}),250);case 6:case"end":return a.stop()}}),a)})))()},handleExportExcel:function(){this.requestStatisticalSupplierListExport(),console.log("export excel")},requestStatisticalSupplierListExport:function(){var t=this;this.listQuery.type_statistical=this.source_id,h.export_statistical(this.listQuery).then((function(e){var a=e.error,l=e.link;console.log(".................. thong ke ",JSON.stringify(e),t.loadingTable),0===a?t.confirmDowload(l):t.$message.error("Lỗi khi xuất file excel")})).catch((function(e){t.loadingTable=!1,console.log("........... error",e)}))},onBack:function(){this.$router.back()},onRefresh:function(){var t=Object(p["b"])(),e=t[0],a=t[1];this.listQuery.date_from=t[0],this.listQuery.date_to=t[1],this.dateRangeProduct=[_()(e).format("YYYY-MM-DD"),_()(a).format("YYYY-MM-DD")],this.getListSupplierAll()},onSearchPressSupplier:function(){this.listQueryAll.page=1,this.getListSupplierAll()}}},g=m,f=(a("a31c"),a("2877")),y=Object(f["a"])(g,l,o,!1,null,"9ec55880",null);e["default"]=y.exports},a31c:function(t,e,a){"use strict";a("c108")},c108:function(t,e,a){},cf43:function(t,e,a){"use strict";a.d(e,"a",(function(){return u}));var l=a("d4ec"),o=a("bee2"),r=a("262e"),i=a("2caf"),n=(a("99af"),a("6c6e")),s=a("a27e"),c="https://shop.vcallid.com/api/public",u=function(t){Object(r["a"])(a,t);var e=Object(i["a"])(a);function a(){return Object(l["a"])(this,a),e.call(this,"")}return Object(o["a"])(a,[{key:"get_name_shop",value:function(t){return Object(s["a"])({url:c+"/shop/get_name_shop?shop_id=".concat(t),method:"get"})}},{key:"statistical_supplier_list",value:function(t){return Object(s["a"])({url:c+"/supplier/statistical_supplier_list",method:"get",params:t})}},{key:"list_statistical_supplier",value:function(t){return Object(s["a"])({url:c+"/statistical/list_statistical_supplier",method:"get",params:t})}},{key:"list_statistical_supplier_for_all",value:function(t){return Object(s["a"])({url:c+"/statistical/list_statistical_supplier_for_all",method:"get",params:t})}},{key:"list_product_order",value:function(t){return Object(s["a"])({url:c+"/statistical/get_list_products_order",method:"get",params:t})}},{key:"export_statistical",value:function(t){return Object(s["a"])({url:c+"/statistical/export_statistial",method:"get",params:t})}},{key:"statistical_home",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(s["a"])({url:c+"/supplier/statistical_home?shop_id=".concat(t),method:"get"})}},{key:"statistical_line_chart_week",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(s["a"])({url:c+"/supplier/statistical_line_chart?shop_id=".concat(t,"&chanel=").concat(e),method:"get"})}},{key:"statistical_revenue",value:function(t){return Object(s["a"])({url:c+"/supplier/statistical_revenue",method:"get",params:t})}},{key:"shopList",value:function(t){return Object(s["a"])({url:c+"/shop/list",method:"get",params:t})}}]),a}(n["a"])},ee1c:function(t,e,a){"use strict";a("49bd")},f966:function(t,e,a){"use strict";a("b0c0");var l=function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"dialog-show-info",staticStyle:{right:"0px"},attrs:{visible:t.showDetail,width:"100%","before-close":t.handleClose,"close-on-click-modal":!1,"lock-scroll":!1},on:{"update:visible":function(e){t.showDetail=e}}},[e("h3",{staticStyle:{color:"black"}},[t._v(t._s(1===t.listQuery.type_statistical?t.name.length?"Danh sách sản phẩm trong đơn thống kê nhà cung cấp(".concat(t.name,")"):"Danh sách sản phẩm trong đơn thống kê":t.name.length?"Danh sách sản phẩm trong đơn thống kê kênh(".concat(t.name,")"):"Danh sách sản phẩm trong đơn thống kê"))]),e("div",{staticStyle:{"margin-top":"20px"},attrs:{id:"brand-table-id"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,align:"center",border:""}},[e("el-table-column",{attrs:{prop:"code",label:"Mã SP",align:"center",width:"80px"}}),e("el-table-column",{attrs:{prop:"logo",label:"Logo",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("img",{staticStyle:{width:"100px"},attrs:{src:a.row.logo?a.row.logo:""},on:{error:function(e){return t.handleImageError(a.row)}}})]}}])}),e("el-table-column",{attrs:{prop:"name",label:"Tên sản phẩm",align:"center"}}),e("el-table-column",{attrs:{prop:"category_name",label:"Hạng mục",align:"center"}}),e("el-table-column",{attrs:{prop:"number",label:"Số lượng",align:"center",width:"90px"}}),e("el-table-column",{attrs:{prop:"size",label:"Thuộc tính 1",align:"center"}}),e("el-table-column",{attrs:{prop:"color",label:"Thuộc tính 2",align:"center"}}),e("el-table-column",{attrs:{prop:"priceFormat",label:"Giá niêm yết",align:"center"}}),e("el-table-column",{attrs:{prop:"priceSaleFormat",label:"Giá bán",align:"center"}}),e("el-table-column",{attrs:{prop:"costFormat",label:"Giá nhập",align:"center"}})],1),e("el-row",[e("pagination",{attrs:{total:t.total,limit:t.listQuery.limit,page:t.listQuery.page},on:{"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},"update:page":function(e){return t.$set(t.listQuery,"page",e)},pagination:t.getListOrder}})],1)],1)])},o=[],r=(a("a9e3"),a("e9c4"),a("d3b7"),a("159b"),a("ac1f"),a("5319"),a("0d87")),i=a("333d"),n=a("bcc2"),s=new r["a"],c={name:"DialogOrderProducts",components:{Pagination:i["a"]},props:{objectData:{type:Object,default:function(){return{}}},offsetTop:{type:Number,default:0}},data:function(){return{dialog:{titleName:"Thông tin doanh thu đơn hàng"},tableData:[],loading:!1,listQuery:{page:1,limit:10},total:0,showDetail:!1,shop_id:0,name:""}},mounted:function(){this.listQuery.delivery_bill_id=this.objectData.id,this.getListOrder(),console.log("objectData",this.objectData)},methods:{formatNumber:n["k"],handleClose:function(){this.showDetail=!1},handleImageError:function(t){t.showImage=!1},show:function(t,e,a,l){this.showDetail=t,this.tableData=[],this.shop_id=a.id,console.log(".........thong tin san pham ",JSON.stringify(l)),this.listQuery.limit=8,this.listQuery.page=1,this.listQuery.date_from=l.date_from,this.listQuery.date_to=l.date_to,this.listQuery.type_statistical=l.type_statistical,this.listQuery.id=this.shop_id,this.name=a.name,this.getListOrder()},getListOrder:function(){var t=this;this.loading=!0,s.listStatisticalOrder(this.listQuery).then((function(e){console.log("Danh sach san pham thong ke: ",JSON.stringify(e));var a=e.error,l=e.data,o=e.total;0===a&&(1===t.listQuery.page&&(t.total=o),t.tableData=l,t.tableData.forEach((function(e,a){e.stt=(t.listQuery.page-1)*t.listQuery.limit+a+1,e.code=e.product_code,e.logo=e.thumb,e.size=e.size?e.size.replace("null",""):"",e.color=e.color?e.color.replace("null",""):"",e.priceFormat=t.formatNumber(e.price)+"đ",e.priceSaleFormat=t.formatNumber(e.price_sale)+"đ",e.costFormat=t.formatNumber(e.cost)+"đ",e.profit=t.formatNumber(e.profit)+"đ",e.category_name=e.category?e.category.name:""})))})).catch((function(e){console.log(e),t.$message.error("Lỗi khi lấy dữ liệu đơn hàng")})).finally((function(){t.loading=!1}))}}},u=c,p=(a("ee1c"),a("2877")),d=Object(p["a"])(u,l,o,!1,null,"6884f14b",null);e["a"]=d.exports}}]);